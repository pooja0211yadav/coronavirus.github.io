webpackJsonp(["whiteboard"],{"../../../../workspace/node_modules/collab-js-whiteboard/dist/adapters/wb-jinx-adapter.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js");e.getNewInstance=function(){return new n};var n=function(){function t(){}return t.prototype.initProcessor=function(t){this.wbProcessor=t,this.jinxMessaging.setViewReady(!!this.wbProcessor)},t.prototype.getMyId=function(){return this.id},t.prototype.send=function(t,e,o){var n,s=t;switch(t){case"draw":s="draw",n="add";break;case"draw_pointer":s="point",n="add";break;case"update":s="draw",n="update";break;case"update_pointer":s="point",n="update";break;case"remove":s="draw",n="remove";break;case"remove_pointer":s="point",n="remove";break;default:i.warn("Unknown action:",t)}var r=JSON.stringify(e);"draw"===s?this.jinxMessaging.draw(n,r,o):"point"===s?this.jinxMessaging.point(n,r):i.warn("Unknown method:",s)},t.prototype.initJinxMessaging=function(t){this.jinxMessaging=t,this.jinxMessaging.initAdapter(this)},t.prototype.setMyId=function(t){this.id=t},t.prototype.setBaseUrl=function(t){this.wbProcessor&&(this.wbProcessor.baseUrl=t)},t.prototype.processReset=function(t,e){if(void 0===e&&(e=!1),this.wbProcessor){if(t&&t.length){var o=this.parseJSON(t);if(o&&("background"===o.action||!0===o.reset))return this.wbProcessor.processUpdate(o),void(e&&this.updatesComplete())}this.wbProcessor.reset(e)}},t.prototype.processClear=function(t){void 0===t&&(t=!0),this.wbProcessor&&this.wbProcessor.clear(t)},t.prototype.processPoint=function(t,e){void 0===e&&(e=!0),this.processUpdate(t)&&e&&this.updatesComplete()},t.prototype.processDraw=function(t,e){void 0===e&&(e=!1),this.processUpdate(t)&&e&&this.updatesComplete()},t.prototype.processParticipantExit=function(t){if(this.wbProcessor){var e="pointer_"+t;this.wbProcessor.processUpdate({uid:t,data_id:e,action:"remove_pointer"})}},t.prototype.updatesComplete=function(){this.wbProcessor&&this.wbProcessor.updatesComplete()},t.prototype.processUpdate=function(t){if(!this.wbProcessor)return!1;var e=this.parseJSON(t);return e&&this.wbProcessor.processUpdate(e),!!e},t.prototype.parseJSON=function(t){var e;try{e=JSON.parse(t)}catch(e){return void i.error("error parsing json payload:",t)}return e},t}();e.WhiteboardJinxAdapter=n},"../../../../workspace/node_modules/collab-js-whiteboard/dist/content-sizer.js":function(t,e,o){var i=o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/collab-js-whiteboard/node_modules/hammerjs/hammer.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),i=o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),l=function(){function t(){this._align_top=!0,this._fit=t.FIT_BEST,this._desired_zoom=1,this.active=!1,this.isRTL=!1,this.noTouchEvents=!1,this.pinchStartScale=null,this.pinchStartZoom=null,this.panStartScrollX=null,this.panStartScrollY=null,this.abs_min_zoom=.1,this.abs_max_zoom=5}return t.getNewInstance=function(){return new t},t.prototype.teardown=function(){a.debug("Tearing down content-sizer."),this.active=!1,delete this.resizeSensor},t.prototype.init=function(t,e,o,s){var a=n.defaults(s,{uiCallback:null,sizeCallback:null,isRTL:!1,alignTop:!0,minSize:50,noTouchEvents:!1,maxHeight:null,maxWidth:null,absMinZoom:.1,absMaxZoom:5});this.isRTL=a.isRTL,this._align_top=a.alignTop,this.minSize=a.minSize,this.noTouchEvents=a.noTouchEvents,this.max_content_height=a.maxHeight,this.max_content_width=a.maxWidth,this.has_max_content_size=!!this.max_content_height&&!!this.max_content_width,this.abs_min_zoom=a.absMinZoom,this.abs_max_zoom=a.absMaxZoom,"object"==typeof a.uiCallback&&(this.uiCallback=a.uiCallback),"object"==typeof a.sizeCallback&&(this.sizeCallback=a.sizeCallback),this.containerOuter=r(t),this.containerOuter.css({height:"100%",width:"100%",position:"relative",overflow:"auto"}),this.containerOuter.attr("dir","ltr"),this.contentContainer=r(e),this.contentContainer.css({position:"absolute",overflow:"hidden"}),this.eventObject=r(o),this.resizeSensor=new i(this.contentContainer.parent()[0],r.proxy(this.resizeContents,this)),this.bindTouchEvents()},t.prototype._update_zoom=function(t){null!==t&&0!==t&&(t<this.abs_min_zoom&&(t=this.abs_min_zoom),t>this.abs_max_zoom&&(t=this.abs_max_zoom),t<this.min_zoom&&(t=this.min_zoom),t>this.max_zoom&&(t=this.max_zoom),this._desired_zoom!==t&&(this._desired_zoom=t,this.resizeContents()))},t.prototype._update_fit=function(t){var e=this;this._fit=t,this._desired_zoom=1,this.uiCallback&&this.uiCallback.fitChanged(this._fit),this.resizeContents(),setTimeout(r.proxy(function(){e.resizeContents()},this),50)},Object.defineProperty(t.prototype,"alignTop",{get:function(){return this._align_top},set:function(t){this._align_top=t,this.resizeContents()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveZoom",{get:function(){return this.effective_zoom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desiredZoom",{get:function(){return this._desired_zoom},set:function(t){this._update_zoom(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fit",{get:function(){return this._fit},set:function(t){this._update_fit(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitWidth",{get:function(){return this._fit===t.FIT_WIDTH},set:function(e){this._update_fit(e?t.FIT_WIDTH:t.FIT_BEST)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitHeight",{get:function(){return this._fit===t.FIT_HEIGHT},set:function(e){this._update_fit(e?t.FIT_HEIGHT:t.FIT_BEST)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitActual",{get:function(){return this._fit===t.FIT_ACTUAL},set:function(e){this._update_fit(e?t.FIT_ACTUAL:t.FIT_BEST)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fitBest",{get:function(){return this._fit===t.FIT_BEST},set:function(e){this._update_fit(e?t.FIT_BEST:t.FIT_ACTUAL)},enumerable:!0,configurable:!0}),t.prototype.isLandscape=function(){return this.orig_aspect>=1},t.prototype.getAspect=function(){return this.orig_aspect},t.prototype.bindTouchEvents=function(){this.noTouchEvents||(this.hammer=new s.Manager(this.eventObject[0]),this.hammer.add(new s.Tap({event:"doubletap",taps:2})),this.hammer.add(new s.Pinch),this.hammer.add(new s.Pan),this.hammer.on("doubletap",r.proxy(this.handleDoubleTap,this)),this.hammer.on("pinchstart pinchmove pinchend pinchcancel",r.proxy(this.handlePinch,this)),this.hammer.on("panstart panmove panend pancancel",r.proxy(this.handlePan,this)),this.enableTouchEvents(!0),this.eventObject.on("wheel",r.proxy(this.handleWheel,this)))},t.prototype.enableTouchEvents=function(t){this.hammer&&(this.hammer.options.enable=t)},t.prototype.handleWheel=function(t){if(t.ctrlKey||t.metaKey){var e=t.originalEvent.deltaY;switch(t.originalEvent.deltaMode){case 1:e*=12;break;case 2:e*=100}var o=e/100;o>.25&&(o=.25),o<-.25&&(o=-.25);var i=this._desired_zoom+o;this._update_zoom(i),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}},t.prototype.handlePan=function(t){"panstart"===t.type&&(this.panStartScrollX=this.containerOuter.scrollLeft(),this.panStartScrollY=this.containerOuter.scrollTop()),"pancancel"===t.type?(this.containerOuter.scrollLeft(this.panStartScrollX),this.containerOuter.scrollTop(this.panStartScrollY)):(this.containerOuter.scrollLeft(this.panStartScrollX-t.deltaX),this.containerOuter.scrollTop(this.panStartScrollY-t.deltaY)),"panend"===t.type&&(this.panStartScrollX=null,this.panStartScrollY=null)},t.prototype.handleDoubleTap=function(t){var e=n.get(t.target,"tagName","").toLowerCase();if("text"===e||"input"===e)return!0;var o=1===this._desired_zoom?1.5:1;a.debug("handleDoubleTap",o),this._update_zoom(o)},t.prototype.handlePinch=function(t){if(a.debug("handlePinch",t),"pinchstart"===t.type&&(this.pinchStartScale=t.scale,this.pinchStartZoom=this._desired_zoom,this.panStartScrollX=this.containerOuter.scrollLeft(),this.panStartScrollY=this.containerOuter.scrollTop()),"pinchcancel"===t.type)this._update_zoom(this.pinchStartZoom),this.containerOuter.scrollLeft(this.panStartScrollX),this.containerOuter.scrollTop(this.panStartScrollY);else{this._update_zoom(this.pinchStartZoom*(t.scale/this.pinchStartScale));var e=t.center.x/this.orig_width*this.content_width-this.client_width/2;this.containerOuter.scrollLeft(e),this.containerOuter.scrollTop(t.center.y/this.orig_height*this.content_height-this.client_height/2)}"pinchend"===t.type&&(this.pinchStartScale=null,this.pinchStartZoom=null)},t.prototype.updateContentSize=function(t,e,o){void 0===o&&(o=!1);var i=this.orig_aspect;this.orig_width=t,this.orig_height=e,this.orig_aspect=this.orig_width/this.orig_height,i!==this.orig_aspect&&this.uiCallback&&this.uiCallback.aspectChanged(this.orig_aspect,this.orig_aspect>=1),this.active?this.resizeContents():(this.active=!0,this.resizeContents(),this.uiCallback&&this.uiCallback.contentReady())},t.prototype.resetScroll=function(){var t=this;setTimeout(r.proxy(function(){t.containerOuter.scrollTop(0),t.isRTL?t.containerOuter.scrollLeft(9999):t.containerOuter.scrollLeft(0)},this),50)},t.prototype.checkRTLScroll=function(t){var e=this;void 0===t&&(t=!1),a.debug("checkRTLScroll","forceResetLeft:",t,"isRTL",this.isRTL,"scrollLeft:",this.containerOuter.scrollLeft()),this.isRTL&&(t||0===this.containerOuter.scrollLeft())&&setTimeout(r.proxy(function(){e.containerOuter.scrollLeft(9999)},this),50)},t.prototype.resetInnerScroll=function(){this.contentContainer.scrollTop(0),this.contentContainer.scrollLeft(0)},t.prototype.resizeContents=function(){if(this.active){var t=!1;this.isRTL&&this.client_width&&this.client_width&&this.containerOuter.scrollLeft()+this.client_width>this.content_width-15&&(t=!0),this.client_width=Math.max(this.minSize,this.contentContainer.parent()[0].clientWidth),this.client_height=Math.max(this.minSize,this.contentContainer.parent()[0].clientHeight),this.client_aspect=this.client_width/this.client_height,this.effective_zoom=this._desired_zoom;var e=!1;if(this._fit.width||this._fit.height)this._fit.height&&this._fit.width&&this.client_aspect>this.orig_aspect||this._fit.height&&!this._fit.width?(this.content_height=this.client_height*this._desired_zoom,this.min_zoom=Math.max(this.abs_min_zoom,Math.min(1,this.client_width/(this.client_height*this.orig_aspect))),this.has_max_content_size?(this.content_height>this.max_content_height&&(e=!0,this.content_height=this.max_content_height,this.effective_zoom=this.max_content_height/this.client_height,a.debug("Content cannot scale all the way to the client height, zooming to "+this.effective_zoom+" instead of "+this._desired_zoom)),this.max_zoom=Math.min(this.abs_max_zoom,this.max_content_height/this.client_height)):this.max_zoom=this.abs_max_zoom,this.content_width=this.content_height*this.orig_aspect,this.has_max_content_size&&(this.max_zoom=Math.min(this.max_zoom,this.max_content_width/(this.content_width/this.effective_zoom)),this.content_width>this.max_content_width&&(e=!0,this.content_width=this.max_content_width,this.content_height=this.content_width/this.orig_aspect,this.effective_zoom=this.content_height/this.client_height,a.debug("Content cannot scale all the way to the client width, zooming to "+this.effective_zoom+" instead of "+this._desired_zoom))),this.effective_zoom<this.min_zoom&&!e&&(this.content_height=this.client_height*this.min_zoom,this.content_width=this.content_height*this.orig_aspect,this.effective_zoom=this.min_zoom,a.debug("Content cannot scale less than the min zoom, zooming to "+this.effective_zoom+" instead of "+this._desired_zoom)),this.content_top=(this.client_height-this.content_height)/2,this.content_left=(this.client_width-this.content_width)/2):(this.content_width=this.client_width*this._desired_zoom,this.min_zoom=Math.max(this.abs_min_zoom,Math.min(1,this.client_height/(this.client_width/this.orig_aspect))),this.has_max_content_size?(this.content_width>this.max_content_width&&(e=!0,this.content_width=this.max_content_width,this.effective_zoom=this.max_content_width/this.client_width,a.debug("Content cannot scale all the way to the client width, zooming to "+this.effective_zoom+" instead of "+this._desired_zoom)),this.max_zoom=Math.min(this.abs_max_zoom,this.max_content_width/this.client_width)):this.max_zoom=this.abs_max_zoom,this.content_height=this.content_width/this.orig_aspect,this.has_max_content_size&&(this.max_zoom=Math.min(this.max_zoom,this.max_content_height/(this.content_height/this.effective_zoom)),this.content_height>this.max_content_height&&(e=!0,this.content_height=this.max_content_height,this.content_width=this.content_height*this.orig_aspect,this.effective_zoom=this.content_width/this.client_width,a.debug("Content cannot scale all the way to the client height, zooming to "+this.effective_zoom+" instead of "+this._desired_zoom))),this.effective_zoom<this.min_zoom&&!e&&(this.content_width=this.client_width*this.min_zoom,this.content_height=this.content_width/this.orig_aspect,this.effective_zoom=this.min_zoom,a.debug("Content cannot scale less than the client size, zooming to "+this.effective_zoom+" instead of "+this._desired_zoom)),this.content_left=(this.client_width-this.content_width)/2,this.content_top=(this.client_height-this.content_height)/2);else{a.debug("original size: ",this.orig_width,this.orig_height),this.has_max_content_size?this.max_zoom=Math.min(this.abs_max_zoom,this.max_content_width/this.orig_width,this.max_content_height/this.orig_height):this.max_zoom=this.abs_max_zoom,this.content_height=this.orig_height*this._desired_zoom,this.content_width=this.orig_width*this._desired_zoom,this.has_max_content_size&&(this.content_height>this.max_content_height&&(e=!0,this.content_height=this.max_content_height,this.content_width=this.content_height*this.orig_aspect,this.effective_zoom=this.max_content_height/this.orig_height,a.debug("Content cannot scale all the way to the client height.")),this.content_width>this.max_content_width&&(e=!0,this.content_width=this.max_content_width,this.content_height=this.max_content_width/this.orig_aspect,this.effective_zoom=this.max_content_width/this.orig_width,a.debug("Content cannot scale all the way to the client width.")));var o,i;o=this.orig_width<this.client_width?1:this.client_width/this.orig_width,i=this.orig_height<this.client_height?1:this.client_height/this.orig_height,this.min_zoom=Math.max(this.abs_min_zoom,Math.min(o,i)),a.debug("Zoom Test: ",o+", "+i+", "+this.effective_zoom+", "+this.min_zoom),this.effective_zoom<this.min_zoom&&!e&&(this.content_height=this.orig_height*this.min_zoom,this.content_width=this.orig_width*this.min_zoom,this.effective_zoom=this.min_zoom,a.debug("Content cannot scale less than the client size and/or the original size.")),this.content_left=(this.client_width-this.content_width)/2,this.content_top=(this.client_height-this.content_height)/2}a.debug("Zoom: ",this.effective_zoom,this.max_zoom,this.min_zoom),this.checkRTLScroll(t),this.last_zoom===this.effective_zoom&&this.last_zoom_max===this.max_zoom&&this.last_zoom_min===this.min_zoom||(this.last_zoom=this.effective_zoom,this.last_zoom_max=this.max_zoom,this.last_zoom_min=this.min_zoom,this.uiCallback&&this.uiCallback.zoomChanged(this.effective_zoom,this.max_zoom,this.min_zoom)),(this.content_top<0||this._align_top)&&(this.content_top=0),this.content_left<0&&(this.content_left=0);var n={top:Math.floor(this.content_top),left:Math.floor(this.content_left),width:Math.floor(this.content_width),height:Math.floor(this.content_height)},s={width:Math.floor(this.content_width),height:Math.floor(this.content_height)};this.contentContainer.css(n),this.sizeCallback&&this.sizeCallback.sizeContents(s)}},t.FIT_ACTUAL={width:!1,height:!1},t.FIT_WIDTH={width:!0,height:!1},t.FIT_HEIGHT={width:!1,height:!0},t.FIT_BEST={width:!0,height:!0},t}();e.ContentSizer=l},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-layer.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/paper/dist/paper-full.js"),n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),s=o("../../../../workspace/node_modules/lil-uuid/uuid.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/nothing-tool.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/select-tool.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/pointer-tool.js"),h=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/freehand-tool.js"),d=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/line-tool.js"),u=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/rectangle-tool.js"),p=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/ellipse-tool.js"),f=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/text-tool.js");e.getNewInstance=function(t,e){return new m(t,e)};var m=function(){function t(t,e){this.controller=t,this.paperscope=new i.PaperScope,this._canvas_scale=1.5;var o=Math.max(this.controller.defaultWidth,this.controller.defaultHeight)*this._canvas_scale;this._canvas_width=o,this._canvas_height=o,n.info("Canvas size is "+this._canvas_width+" by "+this._canvas_height),this.init(e)}return t.prototype.init=function(t){var e=this,o="";this.controller.opt.disableHiDPI&&(o=" hidpi='off'"),t.append(r("<canvas class='wb_canvas'"+o+"></canvas>")),t.append(r("<input class='wb_textinput' type='text' name='wb_textinput'"+(this.controller.opt.isRTL?" dir='rtl'":"")+" />")),this.wbCanvas=t.find(".wb_canvas"),this.wbCanvas.css({"background-color":"transparent",position:"absolute"}),this.textArea=t.find(".wb_textinput"),this.textArea.css({border:0,position:"absolute",display:"none",width:"200px",margin:"0px",padding:"0px"}),this.paperscope.setup(this.wbCanvas.get(0)),this.paperscope.activate(),this.paperscope.settings.hitTolerance=6,this.nothingTool=a.initTool(this.paperscope,this.controller,this),this.lineTool=d.initTool(this.paperscope,this.controller,this),this.ellipseTool=p.initTool(this.paperscope,this.controller,this),this.freeHandTool=h.initTool(this.paperscope,this.controller,this),this.freeHandTool.initOpt(this.controller.opt.smoothOptions),this.pointerTool=c.initTool(this.paperscope,this.controller,this),this.pointerTool.my_id=this.controller.getMyId(),this.rectangleTool=u.initTool(this.paperscope,this.controller,this),this.selectTool=l.initTool(this.paperscope,this.controller,this),this.selectTool.textArea=this.textArea,this.textTool=f.initTool(this.paperscope,this.controller,this),this.textTool.textArea=this.textArea,this.nothingTool.activate(),this.paperscope.view.viewSize=new this.paperscope.Size(this._canvas_width,this._canvas_height),this.wbCanvas.on("blur",function(){e.selectTool.turnOff(!1)})},t.prototype.setBackgroundSize=function(t){},t.prototype.size=function(t){this.textTool.accept(),this.selectTool.textAccept(),this._canvas_offset_y=(t.height-this._canvas_height)/2,this._canvas_offset_x=(t.width-this._canvas_width)/2,this._canvas_zoom=t.width/this._canvas_width;var e={top:Math.floor(this._canvas_offset_y),left:Math.floor(this._canvas_offset_x)};this.wbCanvas.css(e),this.paperscope.view.zoom=this._canvas_zoom,this.paperscope.view.update()},t.prototype.setTool=function(t,e,o){var i=!1;if(t)switch(n.debug("setTool - tool:",e,"mode:",o),e){case"draw":this.pointerTool.turnOff(),this.selectTool.turnOff(),i=this.setDrawMode(o);break;case"pointer":this.selectTool.turnOff(),this.pointerTool.activate(),this.controller.opt.touchDuringPointer&&(i=!0);break;case"select":this.pointerTool.turnOff(),this.selectTool.activate(),this.controller.opt.touchDuringSelect&&(i=!0);break;case"none":this.pointerTool.turnOff(),this.selectTool.turnOff(),this.nothingTool.activate(),i=!0;break;default:n.warn("Unknown Tool Selected - tool:",e,"mode:",o),this.pointerTool.turnOff(),this.selectTool.turnOff(),this.nothingTool.activate(),i=!0}else this.pointerTool.turnOff(),this.selectTool.turnOff(),this.nothingTool.activate();return i},t.prototype.setDrawMode=function(t){switch(t){case"pencil":this.freeHandTool.activate();break;case"rectangle":this.rectangleTool.activate();break;case"ellipse":this.ellipseTool.activate();break;case"line":this.lineTool.activate();break;case"text":this.textTool.activate();break;default:return this.nothingTool.activate(),!0}return!1},t.prototype.resetPointer=function(){this.pointerTool.reset()},Object.defineProperty(t.prototype,"eventObject",{get:function(){return this.wbCanvas},enumerable:!0,configurable:!0}),t.prototype.processUpdate=function(t){switch(t.action){case"update":case"update_pointer":case"draw":case"draw_pointer":var e=!1,o=this.paperscope.project.getItem({data:{id:t.data_id}});o?(this.selectTool.isItemSelected(o)&&(e=!0,this.selectTool.turnOff()),o.remove()):"update"===t.action&&n.warn("processUpdate:","Could not find item to update for: ",t.data_id),this.createPaperObj(t.type,t.item,e);break;case"remove":case"remove_pointer":var i=this.paperscope.project.getItem({data:{id:t.data_id}});i?(this.selectTool.isItemSelected(i)&&this.selectTool.turnOff(),i.remove()):n.warn("Could not find match to remove for:",t.data_id,t)}},t.prototype.createPaperObj=function(t,e,o){switch(t){case"Path":var i=new this.paperscope.Path;i.importJSON(e),o&&i.data.modifiedBy===this.controller.getMyId()&&this.selectTool.setSelection(i);break;case"Shape":var s=new this.paperscope.Shape;s.importJSON(e),o&&s.data.modifiedBy===this.controller.getMyId()&&this.selectTool.setSelection(s);break;case"PointText":var r=new this.paperscope.PointText;r.importJSON(e),o&&r.data.modifiedBy===this.controller.getMyId()&&this.selectTool.setSelection(r);break;default:n.warn("Unknown draw type: ",t)}},t.prototype.clear=function(){this.paperscope.project.clear()},t.prototype.redraw=function(){this.paperscope.view.update()},t.prototype.sendNewItem=function(t){this.initItemId(t);var e={type:t.className,data_id:t.data.id,action:"draw",item:t.exportJSON({asString:!1})};this.controller.send("draw",e,t.data.id)},t.prototype.sendItemUpdate=function(t,e){if(void 0===e&&(e=null),e&&e.data.id&&(t.data.id=e.data.id),!t.data.id)return void this.sendNewItem(t);t.data.modifiedBy=this.controller.getMyId();var o={type:t.className,data_id:t.data.id,action:"update",item:t.exportJSON({asString:!1})};this.controller.send("update",o,t.data.id)},t.prototype.sendItemRemove=function(t){var e={type:t.className,data_id:t.data.id,action:"remove",item:t.exportJSON({asString:!1})};this.controller.send("remove",e,t.data.id)},t.prototype.sendNewPointer=function(t){var e={type:t.className,data_id:t.data.id,action:"draw_pointer",item:t.exportJSON({asString:!1})};this.controller.send("draw_pointer",e,t.data.id)},t.prototype.sendPointerUpdate=function(t){var e={type:t.className,data_id:t.data.id,action:"update_pointer",item:t.exportJSON({asString:!1})};this.controller.send("update_pointer",e,t.data.id)},t.prototype.sendPointerRemove=function(t){var e={type:t.className,data_id:t.data.id,action:"remove_pointer",item:t.exportJSON({asString:!1})};this.controller.send("remove_pointer",e,t.data.id)},t.prototype.initItemId=function(t){t.data.id||(t.data.id=s.uuid(),n.info("generated new item id:",t.data.id)),t.data.modifiedBy=this.controller.getMyId()},t.prototype.focusCanvas=function(){this.wbCanvas.focus()},Object.defineProperty(t.prototype,"canvas_scale",{get:function(){return this._canvas_scale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._canvas_width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this._canvas_height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wbCanvas_based_maxright",{get:function(){return this.wbCanvas.width()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas_offset_x",{get:function(){return this._canvas_offset_x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas_offset_y",{get:function(){return this._canvas_offset_y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas_zoom",{get:function(){return this._canvas_zoom},enumerable:!0,configurable:!0}),t}();e.PaperLayer=m},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js":function(t,e,o){function i(t,e,o){return new r(t,e,o)}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-utils.js"),r=function(){function t(t,e,o){this.paperscope=null,this.tool=null,this.isDown=!1,this.paperscope=t,this.controller=e,this.drawController=o,this.tool=new this.paperscope.Tool,this.setupEvents(["mousedown","mousedrag","mouseup"])}return t.prototype.activate=function(){this.tool.activate()},t.prototype.setupEvents=function(t){var e=this;t||(t=[]),t.indexOf("mousedown")>-1?this.tool.onMouseDown=n.bind(function(t){e.isDown=!1,s.buttonAllowed(t)&&(e.isDown=!0,e.onMouseDown(t))},this):this.tool.onMouseDown=null,t.indexOf("mousedrag")>-1?this.tool.onMouseDrag=n.bind(function(t){s.buttonAllowed(t)&&e.isDown&&e.onMouseDrag(t)},this):this.tool.onMouseDrag=null,t.indexOf("mouseup")>-1?this.tool.onMouseUp=n.bind(function(t){s.buttonAllowed(t)&&e.isDown&&(e.isDown=!1,e.onMouseUp(t))},this):this.tool.onMouseUp=null,t.indexOf("mousemove")>-1?this.tool.onMouseMove=n.bind(function(t){e.onMouseMove(t)},this):this.tool.onMouseMove=null},t.prototype.onMouseDown=function(t){},t.prototype.onMouseDrag=function(t){},t.prototype.onMouseUp=function(t){},t.prototype.onMouseMove=function(t){},t}();e.BaseTool=r,e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/bdi-util.js":function(t,e,o){function i(t){return r+t+a}function n(t){return s+t+a}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var s="‪",r="‫",a="‬";e.add_rle=i,e.add_lre=n},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/ellipse-tool.js":function(t,e,o){function i(t,e,o){return new r(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startPoint=null,e.drawPath=null,e}return n(e,t),e.prototype.onMouseDown=function(t){this.startPoint=t.point,this.drawPath=null,this.tool.minDistance=10},e.prototype.onMouseDrag=function(t){this.setFromPoints(this.startPoint,t.point,t.modifiers.shift),this.tool.minDistance=0},e.prototype.onMouseUp=function(t){this.drawPath&&(this.setFromPoints(this.startPoint,t.point,t.modifiers.shift),this.drawController.sendNewItem(this.drawPath))},e.prototype.setFromPoints=function(t,e,o){if(this.drawPath&&this.drawPath.remove(),o){var i=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)),n=new this.paperscope.Rectangle(t.x-i,t.y-i,2*i,2*i);this.drawPath=new this.paperscope.Path.Ellipse(n)}else{var s=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y),a=new this.paperscope.Rectangle(t.x-s,t.y-r,2*s,2*r);this.drawPath=new this.paperscope.Path.Ellipse(a)}this.drawPath.strokeColor=this.controller.strokeColor,this.drawPath.strokeWidth=this.controller.strokeWidth*this.drawController.canvas_scale},e}(s.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/freehand-tool.js":function(t,e,o){function i(t,e,o){return new l(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.opt=null,e.simplifyWorker=null,e.workerInit=!1,e.drawPath=null,e}return n(e,t),e.prototype.initOpt=function(t){var e=this;if(this.opt=s.defaults(t,{type:"simplify",factor:.5,minDistance:2,tolerance:10,useWorker:!1}),r.debug("FreeHandTool.initOpt",this.opt),this.opt.minDistance&&(this.tool.minDistance=this.opt.minDistance),"simplify"===this.opt.type&&this.opt.useWorker&&window.Worker){this.workerInit=!1,r.debug("FreeHandTool - setting up Worker from: ",this.opt.workerPath);try{this.simplifyWorker=new Worker(this.opt.workerPath)}catch(t){return void r.error("Error creating Worker:",t)}var o=this.drawController;this.simplifyWorker.onmessage=function(t){if(t.data)switch(t.data.msg){case"init_done":r.debug("Simplify worker init complete, will use worker for simplify."),e.workerInit=!0;break;case"simplify_done":var i=t.data.path,n=t.data.id,s=e.paperscope.project.getItem({data:{id:n}});if(r.debug("Simplify results returned from worker.",n),s){var a=s.segments.length,l=s.data.sent;s.importJSON(i),r.debug("Path segment simplified from:",a,"to:",s.segments.length,"in",(new Date).getTime()-t.data.start_time,"ms"),l?(r.debug("This item was already sent, so sending as an update.",n),o.sendItemUpdate(s)):(r.debug("This item had not already sent, so sending as a new item.",n),o.sendNewItem(s)),s.data.sent=!0}else r.debug("Couldn't find a path for this id, perhaps it was already deleted?",n);break;default:r.warn("Unknown event msg in simplify-worker return message: ",t.data.msg)}else r.warn("Empty event data in simplify-worker return message: ",t)}}else this.simplifyWorker=null},e.prototype.onMouseDown=function(t){this.drawPath=new this.paperscope.Path,this.drawPath.add(t.point),this.drawPath.strokeColor=this.controller.strokeColor,this.drawPath.strokeWidth=this.controller.strokeWidth*this.drawController.canvas_scale},e.prototype.onMouseDrag=function(t){this.drawPath.add(t.point)},e.prototype.onMouseUp=function(t){var e=this;this.drawPath.lastSegment.point=t.point,this.drawController.sendNewItem(this.drawPath),r.debug("FreeHandTool.onMouseUp");var o=(new Date).getTime();if("simplify"===this.opt.type&&this.workerInit){this.drawController.initItemId(this.drawPath);var i=this.drawPath.data.id,n=this.drawController;setTimeout(function(){var t=e.paperscope.project.getItem({data:{id:i}});t?t.data.sent?r.debug("Item was already sent, nothing to do.",i):(r.debug("Item was not already sent, and worker results have not returned, sending it now.",i),n.sendNewItem(t),t.data.sent=!0):r.debug("Item could not be found, was it already deleted?",i)},500);var s={msg:"simplify",path:this.drawPath.exportJSON(),tolerance:this.opt.tolerance,id:this.drawPath.data.id,start_time:o,wait:this.opt.wait};r.debug("Posting message to simplify worker: ",s),this.simplifyWorker.postMessage(s)}else if("simplify"===this.opt.type){var a=this.drawPath.segments.length;this.drawPath.simplify(this.opt.tolerance),r.debug("Path segment simplified from:",a,"to:",this.drawPath.segments.length,"in",(new Date).getTime()-o,"ms"),this.drawController.sendNewItem(this.drawPath)}else this.drawPath.smooth({type:this.opt.type,factor:this.opt.factor}),r.debug("Smooth processing time (ms): ",(new Date).getTime()-o),this.drawController.sendNewItem(this.drawPath)},e}(a.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/line-tool.js":function(t,e,o){function i(t,e,o){return new r(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startPoint=null,e.drawPath=null,e}return n(e,t),e.prototype.onMouseDown=function(t){this.startPoint=t.point,this.drawPath=null,this.tool.minDistance=10},e.prototype.onMouseDrag=function(t){this.drawPath?this.drawPath.lastSegment.point=t.point:(this.drawPath=new this.paperscope.Path.Line(this.startPoint,t.point),this.drawPath.strokeColor=this.controller.strokeColor,this.drawPath.strokeWidth=this.controller.strokeWidth*this.drawController.canvas_scale,this.tool.minDistance=0)},e.prototype.onMouseUp=function(t){this.drawPath.lastSegment.point=t.point,this.drawController.sendNewItem(this.drawPath)},e}(s.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/nothing-tool.js":function(t,e,o){function i(t,e,o){return new r(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),r=function(t){function e(e,o,i){var n=t.call(this,e,o,i)||this;return n.setupEvents([]),n}return n(e,t),e}(s.BaseTool);e.NothingTool=r,e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/pointer-tool.js":function(t,e,o){function i(t,e,o){return new c(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-utils.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),c=function(t){function e(e,o,i){var n=t.call(this,e,o,i)||this;return n.latest_point=null,n.my_path=null,n.sendUpdate=null,n.setupEvents(["mousemove"]),n}return n(e,t),e.prototype.onMouseMove=function(t){this.my_id!==this.controller.getMyId()&&(this.my_path&&this.turnOff(),this.my_id=this.controller.getMyId()),this.my_path?(this.latest_point=t.point,this.sendUpdate()):(this.my_path=new this.paperscope.Path(a.hand_icon),this.my_path.strokeColor="black",this.my_path.fillColor="white",this.my_path.data.id="pointer_"+this.my_id,this.latest_point=t.point,this.drawController.sendNewPointer(this.my_path),this.sendUpdate||(this.sendUpdate=s.throttle(r.proxy(this.sendUpdate_impl,this),150)))},e.prototype.sendUpdate_impl=function(){this.my_path.position=this.latest_point,this.drawController.sendPointerUpdate(this.my_path),this.paperscope.view.update()},e.prototype.reset=function(){this.my_path&&this.my_path.remove(),this.my_path=null,this.latest_point=null},e.prototype.turnOff=function(){this.my_path&&(this.drawController.sendPointerRemove(this.my_path),this.reset())},e}(l.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/rectangle-tool.js":function(t,e,o){function i(t,e,o){return new r(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startPoint=null,e.drawPath=null,e}return n(e,t),e.prototype.onMouseDown=function(t){this.startPoint=t.point,this.drawPath=null,this.tool.minDistance=10},e.prototype.onMouseDrag=function(t){this.setFromPoints(this.startPoint,t.point,t.modifiers.shift),this.tool.minDistance=0},e.prototype.onMouseUp=function(t){this.drawPath&&(this.setFromPoints(this.startPoint,t.point,t.modifiers.shift),this.drawController.sendNewItem(this.drawPath))},e.prototype.setFromPoints=function(t,e,o){if(this.drawPath&&this.drawPath.remove(),o){var i=Math.max(Math.abs(e.x-t.x),Math.abs(e.y-t.y)),n=function(t){return 0===t?0:t<0?-1:1},s=new this.paperscope.Point(t.x+n(e.x-t.x)*i,t.y+n(e.y-t.y)*i);this.drawPath=new this.paperscope.Path.Rectangle(t,s)}else this.drawPath=new this.paperscope.Path.Rectangle(t,e);this.drawPath.strokeColor=this.controller.strokeColor,this.drawPath.strokeWidth=this.controller.strokeWidth*this.drawController.canvas_scale},e}(s.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/select-tool.js":function(t,e,o){function i(t,e,o){return new h(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-utils.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/bdi-util.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectedItem=null,e.selectionRect=null,e.modified=!1,e.lastRotatePoint=null,e.lastScalePoint=null,e.hit_item=null,e.textArea=null,e.isEditing=!1,e.editTextItem=null,e._selectStrokeWidth=3,e._selectStrokeColor="#00A0EC",e}return n(e,t),e.prototype.setSelection=function(t){if(!t)return void this.turnOff(!1);if(t!==this.selectionRect){this.turnOff(!1),this.selectedItem=t;var e,o=0===this.selectedItem.rotation&&1===this.selectedItem.scaling.x&&1===this.selectedItem.scaling.y;o?(e=this.selectedItem.bounds,this.selectedItem.data.initialBounds=this.selectedItem.bounds.clone()):e=this.selectedItem.data.initialBounds;var i=e.clone();this.selectionRect=new this.paperscope.Path.Rectangle(i),this.selectionRect.bringToFront(),this.selectionRect.insert(3,new this.paperscope.Point(i.right,i.top+(i.bottom-i.top)/4)),this.selectionRect.position=this.selectedItem.position,this.selectionRect.rotation=this.selectedItem.rotation,this.selectionRect.scaling=this.selectedItem.scaling,this.selectionRect.strokeWidth=this._selectStrokeWidth*this.drawController.canvas_scale,this.selectionRect.strokeColor=this._selectStrokeColor,this.selectionRect.data.selectionRect=!0,this.selectionRect.selected=!0,"PointText"===this.selectedItem.className&&(this.selectedItem.onDoubleClick=r.proxy(this.triggerEdit,this)),this.drawController.focusCanvas(),this.tool.on("keydown",r.proxy(this.onSelectKeyDown,this)),this.modified=!1,this.controller.opt.touchDuringSelect&&this.controller.contentSizer.enableTouchEvents(!1)}},e.prototype.isItemSelected=function(t){return t===this.selectedItem||t===this.editTextItem},e.prototype.triggerEdit=function(t){if(t.target===this.selectedItem&&"PointText"===this.selectedItem.className){this.editTextItem=this.selectedItem,this.setSelection(null);var e=a.parseUnit(this.editTextItem.fontSize);e[0]=e[0]*this.editTextItem.scaling.x,e[0]=e[0]*this.drawController.canvas_zoom;var o=e.join(""),i="rotate("+this.editTextItem.rotation+"deg)";this.textArea.css({"font-family":this.editTextItem.fontFamily,"font-size":o,"font-weight":this.editTextItem.fontWeight,"text-align":"center",height:"auto",color:this.editTextItem.fillColor.toCSS(!0),"-webkit-transform":i,"-moz-transform":i,"-o-transform":i,"-ms-transform":i}),this.tool.off("keydown"),this.textArea.keydown(r.proxy(this.textOnKeyDown,this)),this.textArea.keyup(r.proxy(this.textOnKeyUp,this)),this.textArea.focusout(r.proxy(this.textOnFocusOut,this)),void 0===this.editTextItem.data.text&&(this.editTextItem.data.text=this.editTextItem.content),this.textArea.attr("dir",this.editTextItem.data.dir),this.textArea.attr("aria-label",this.controller.opt.inputLabelEdit),this.textArea.val(this.editTextItem.data.text),this.positionTextBox(),this.textArea.show(),this.textArea.focus(),this.isEditing=!0}},e.prototype.positionTextBox=function(){var t=this,e=this.editTextItem.data.initialBounds;e||(e=this.editTextItem.bounds),e=e.scale(this.editTextItem.scaling.x,this.editTextItem.scaling.y);var o=(this.paperscope.view.projectToView(e.topLeft),this.paperscope.view.projectToView(e.bottomRight),this.paperscope.view.projectToView(e.center)),i="  "+this.textArea.val()+"  ",n=this.controller.measureText(this.textArea.get(0),i),s=o.x+this.drawController.canvas_offset_x-n/2;this.textArea.css({top:o.y+this.drawController.canvas_offset_y-this.textArea.height()/2,left:s,width:n}),setTimeout(function(){t.textArea.css({top:o.y+t.drawController.canvas_offset_y-t.textArea.height()/2})},250)},e.prototype.textAccept=function(){if(this.isEditing){this.isEditing=!1;var t=this.textArea.val(),e=t;if(0===t.length)this.deleteItem(this.editTextItem);else if(t!==this.editTextItem.data.text){"rtl"===this.editTextItem.data.dir?e=l.add_rle(t):"ltr"===this.editTextItem.data.dir&&(e=l.add_lre(t));var o=new this.paperscope.PointText({content:e,data:{text:t,dir:this.editTextItem.data.dir},fillColor:this.editTextItem.fillColor,fontFamily:this.editTextItem.fontFamily,fontWeight:this.editTextItem.fontWeight,fontSize:this.editTextItem.fontSize});o.position=this.editTextItem.position,o.data.initialBounds=o.bounds.clone(),o.scaling=this.editTextItem.scaling,o.rotation=this.editTextItem.rotation,this.drawController.sendItemUpdate(o,this.editTextItem),this.editTextItem.remove(),this.editTextItem=null,this.setSelection(o)}t.length>0&&this.editTextItem&&this.setSelection(this.editTextItem),this.textArea.hide(),this.tool.on("keydown",this.onSelectKeyDown),this.paperscope.view.update(),this.controller.contentSizer.resetInnerScroll()}},e.prototype.textCancel=function(){this.isEditing=!1,this.textArea.hide(),this.setSelection(this.editTextItem),this.tool.on("keydown",this.onSelectKeyDown),this.controller.contentSizer.resetInnerScroll()},e.prototype.textOnKeyDown=function(t){if(this.isEditing)return 13===t.keyCode?(this.textAccept(),void t.preventDefault()):27===t.keyCode?(this.textCancel(),void t.preventDefault()):void 0},e.prototype.textOnKeyUp=function(){this.isEditing&&this.positionTextBox()},e.prototype.textOnFocusOut=function(t){this.textAccept()},e.prototype.turnOff=function(t){void 0===t&&(t=!0),this.isEditing&&t&&this.textCancel(),this.selectedItem=null,this.modified=!1,this.selectionRect&&(this.selectionRect.remove(),this.selectionRect=null,this.paperscope.view.update()),this.tool.off("keydown"),this.controller.opt.touchDuringSelect&&this.controller.contentSizer.enableTouchEvents(!0)},e.prototype.onMouseDown=function(t){this.hit_item=null,this.lastRotatePoint=null,this.lastScalePoint=null;var e=this.paperscope.project.hitTest(t.point);return e&&e.item?e.item!==this.selectionRect&&e.item!==this.selectedItem?(this.setSelection(e.item),void(this.hit_item=e.item)):e.item===this.selectedItem?void(this.hit_item=this.selectedItem):e.item===this.selectionRect?(this.hit_item=this.selectedItem,void("segment"===e.type&&(3===e.segment.index?this.lastRotatePoint=t.point:this.lastScalePoint=t.point))):void 0:void this.turnOff(!1)},e.prototype.onMouseDrag=function(t){if(null!=this.lastScalePoint){var e=this.lastScalePoint.subtract(this.selectionRect.bounds.center).length,o=t.point.subtract(this.selectionRect.bounds.center).length,i=o/e;this.selectionRect.scale(i),this.selectedItem.scale(i),this.lastScalePoint=t.point,this.modified=!0}else if(null!=this.lastRotatePoint){var n=this.lastRotatePoint.subtract(this.selectionRect.bounds.center).angle,s=t.point.subtract(this.selectionRect.bounds.center).angle,r=s-n;this.selectionRect.rotate(r),this.selectedItem.rotate(r),this.lastRotatePoint=t.point,this.modified=!0}else this.hit_item&&this.selectedItem&&(this.selectedItem.position=this.selectedItem.position.add(t.delta),this.selectionRect.position=this.selectionRect.position.add(t.delta),this.selectedItem.data.initialBounds.center=this.selectedItem.data.initialBounds.center.add(t.delta),this.modified=!0)},e.prototype.onMouseUp=function(t){this.selectedItem&&this.modified&&this.drawController.sendItemUpdate(this.selectedItem),this.modified=!1,this.setSelection(this.selectedItem)},e.prototype.onSelectKeyDown=function(t){this.isEditing||!this.selectedItem||this.isTextField(t.event)||"backspace"!==t.key&&"delete"!==t.key||(t.event.preventDefault(),this.deleteItem(this.selectedItem))},e.prototype.deleteItem=function(t){t&&(this.drawController.sendItemRemove(t),t.remove(),this.turnOff(!1))},e.prototype.isTextField=function(t){return 0===s.get(t,"target.type","").indexOf("text")},e}(c.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/text-tool.js":function(t,e,o){function i(t,e,o){return new c(t,e,o)}var n=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var s=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-utils.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/bdi-util.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/base-tool.js"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.insertPoint=null,e.viewPoint=null,e.textArea=null,e.isEditing=!1,e.minWidth=100,e.fontSize="",e}return n(e,t),e.prototype.textOnKeyDown=function(t){return 13===t.keyCode?(this.accept(),void t.preventDefault()):27===t.keyCode?(this.cancel(),void t.preventDefault()):void 0},e.prototype.textOnKeyUp=function(t){this.positionTextBox()},e.prototype.textOnFocusOut=function(t){this.accept()},e.prototype.positionTextBox=function(){var t="  "+this.textArea.val()+"  ",e=this.controller.measureText(this.textArea.get(0),t),o=this.viewPoint.x+this.drawController.canvas_offset_x-e,i=(this.viewPoint.x+this.drawController.canvas_offset_x+e)/this.drawController.canvas_zoom,n=this.drawController.wbCanvas_based_maxright;this.controller.opt.isRTL?this.textArea.css({left:o,width:e}):i<=n&&this.textArea.css({width:e})},e.prototype.onMouseDown=function(t){if(r.buttonAllowed(t)){this.isEditing&&this.accept(),this.insertPoint=t.point,this.viewPoint=this.paperscope.view.projectToView(t.point);var e=r.parseUnit(this.controller.fontSize);e[0]=e[0]*this.drawController.canvas_scale,this.fontSize=e.join(""),e[0]=e[0]*this.drawController.canvas_zoom;var o=e.join(""),i="rotate(0deg)";this.textArea.css({top:this.viewPoint.y+this.drawController.canvas_offset_y-this.textArea.height()/2,left:this.viewPoint.x+this.drawController.canvas_offset_x-5,width:"200px",height:"auto","font-family":this.controller.fontFamily,"font-size":o,"font-weight":this.controller.fontWeight,color:this.controller.strokeColor,"-webkit-transform":i,"-moz-transform":i,"-o-transform":i,"-ms-transform":i}),this.controller.opt.isRTL?this.textArea.css({"text-align":"right"}):this.textArea.css({"text-align":"left","padding-left":"5px"}),this.textArea.keyup(s.proxy(this.textOnKeyUp,this)),this.textArea.keydown(s.proxy(this.textOnKeyDown,this)),this.textArea.focusout(s.proxy(this.textOnFocusOut,this)),this.textArea.attr("dir",this.controller.opt.isRTL?"rtl":"ltr"),this.textArea.attr("aria-label",this.controller.opt.inputLabelNew),this.textArea.val(""),this.positionTextBox(),this.textArea.show(),this.textArea.focus(),this.isEditing=!0}},e.prototype.accept=function(){if(this.isEditing){this.isEditing=!1;var t=this.textArea.val(),e=t;if(t.length>0){e=this.controller.opt.isRTL?a.add_rle(t):a.add_lre(t);var o=this.insertPoint.x,i=this.insertPoint.y+7;if(this.controller.opt.isRTL){var n=this.controller.measureText(this.textArea.get(0),e);o=this.insertPoint.x-n/this.drawController.canvas_zoom}var s=new this.paperscope.PointText({point:[o,i],content:e,data:{text:t,dir:this.controller.opt.isRTL?"rtl":"ltr"},fillColor:this.controller.strokeColor,fontFamily:this.controller.fontFamily,fontWeight:this.controller.fontWeight,fontSize:this.fontSize});this.drawController.sendNewItem(s)}this.textArea.hide(),this.paperscope.view.update(),this.controller.contentSizer.resetInnerScroll()}},e.prototype.cancel=function(){this.isEditing=!1,this.textArea.hide(),this.controller.contentSizer.resetInnerScroll()},e}(l.BaseTool);e.initTool=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-layer.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/svg.js/dist/svg.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/tools.js");o("../../../../workspace/node_modules/svg.path.js/svg.path.js"),o("../../../../workspace/node_modules/svg.resize.js/dist/svg.resize.js"),o("../../../../workspace/node_modules/svg.select.js/dist/svg.select.js"),o("../../../../workspace/node_modules/svg.draggable.js/dist/svg.draggable.js");var l={"background-color":"transparent",position:"absolute",top:0,left:0,height:"100%",width:"100%","touch-action":"none"};e.getNewInstance=function(t,e){return new c(t,e)};var c=function(){function t(t,e){this.controller=t,e.append(r("<div class='svg_layer' tabindex=0></div>")),this.svgDiv=e.find(".svg_layer"),this.svgDiv.css(l),this.disableAria(),this.svgDraw=s(this.svgDiv[0]),this.svgDraw.size("100%","100%"),this.svgDraw.id("wb-svg-main"),r(this.svgDraw.native()).css({"touch-action":"none"}),this.tools=a.initTools(this.svgDraw,this.controller,this),this.tools.text.initTool(this.svgDiv),this.tools.select.initTool(this.svgDiv,this.tools.text)}return Object.defineProperty(t.prototype,"cursor",{get:function(){return this.svgDiv.css("cursor")},set:function(t){this.svgDiv.css("cursor",t)},enumerable:!0,configurable:!0}),t.prototype.disableAria=function(){return this.svgDiv.attr("aria-hidden","true")},t.prototype.setBackgroundSize=function(t){this.backgroundSize=t,this.svgDraw.viewbox(0,0,t.width,t.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this.backgroundSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.backgroundSize.height},enumerable:!0,configurable:!0}),t.prototype.size=function(){this.tools.text.completeEdit(),this.tools.select.onSize()},t.prototype.setTool=function(t,e,o){i.debug("setTool","|tool:"+e+"|mode:"+o+"|enabled:"+t+"|");var s=n.get(this.tools,"draw"===e?o:e,null),r=t?s:null;return this.currTool&&r!==this.currTool&&this.currTool.deactivate(),r&&r!==this.currTool&&r.activate(),this.currTool=r,this.areTouchEventsActiveForTool(e)},t.prototype.resetPointer=function(){this.tools.pointer.reset()},Object.defineProperty(t.prototype,"eventObject",{get:function(){return this.svgDiv},enumerable:!0,configurable:!0}),t.prototype.processUpdate=function(t){var e=s.get(t.id);if(this.tools.pointer.isPointerAction(t))return this.tools.pointer.processPointerUpdate(t);n.isNull(e)||e.remove(),this.isRemoveAction(t.action)||this.svgDraw.svg(t.svg),!n.isNull(e)&&this.currTool&&this.currTool.onUpdate(t.id)},t.prototype.clear=function(){this.svgDraw.clear()},t.prototype.sendItem=function(t,e){void 0===e&&(e="draw");var o=t.attr("id"),n=t.type,s=t.svg(),r=this.controller.getMyId();t.data("modifiedBy",this.controller.getMyId()),i.info("sendItem|"+e+"|"+o+"|"+n),this.controller.send(e,{layer:"svg",type:n,id:o,action:e,svg:s,uid:r},o)},t.prototype.sendPointerUpdate=function(t,e){var o=this.controller.getMyId();i.info("sendPointerUpdate|"+e+"|"+t.x+","+t.y),this.controller.send(e,{layer:"svg",point:t,action:e,uid:o},o)},t.prototype.deleteItem=function(t,e){void 0===e&&(e="remove"),this.sendItem(t,e),t.remove()},t.prototype.redraw=function(){},t.prototype.focusCanvas=function(){this.svgDiv.focus()},t.prototype.areTouchEventsActiveForTool=function(t){return"draw"!==t&&(!("pointer"!==t||!this.controller.opt.touchDuringPointer)||!("select"!==t||!this.controller.opt.touchDuringSelect))},t.prototype.isRemoveAction=function(t){return"remove"===t},t}();e.SvgLayer=c},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/base-draw.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__assign||Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++){e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t});Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/event-helpers.js"),r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/svg-helpers.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),l=o("../../../../workspace/node_modules/lil-uuid/uuid.js"),c=function(){function t(t,e,o){this.svgDraw=t,this.wbController=e,this.drawController=o,this.activeDrawing={},this.minDistance=10}return t.prototype.activate=function(){var t=this.svgDraw;t.on("mousedown",this.onDown,this),t.on("touchstart",this.onDown,this,s.notpassive),t.on("mousemove",this.onMove,this),t.on("touchmove",this.onMove,this,s.notpassive),document.addEventListener("mouseup",this.onEnd.bind(this)),document.addEventListener("touchend",this.onEnd.bind(this)),document.addEventListener("touchcancel",this.onEnd.bind(this))},t.prototype.deactivate=function(){this.svgDraw.off(),document.removeEventListener("mouseup",this.onEnd),document.removeEventListener("touchend",this.onEnd),document.removeEventListener("touchcancel",this.onEnd)},t.prototype.onUpdate=function(t){},t.prototype.onDown=function(t){if(s.isInvalidMouse(t))return!0;if(s.isInvalidTouch(t))return this.onEnd(t);var e=r.svgPointForEvent(s.eventXY(t),this.svgDraw.native());return this.activeDrawing=this.initDrawing(e.x,e.y,t.shiftKey),s.acceptEvent(t)},t.prototype.onMove=function(t){if(!this.hasDrawingStarted()||s.isInvalidMouse(t))return!0;var e=r.svgPointForEvent(s.eventXY(t),this.svgDraw.native());return this.updateDrawing(e.x,e.y,t.shiftKey),this.updateDrawCoords(),s.acceptEvent(t)},t.prototype.onEnd=function(t){return!this.hasDrawingStarted()||(this.completeDrawing(),s.acceptEvent(t))},t.prototype.updateDrawCoords=function(){var t=n.isNil(this.activeDrawing.element);if(this.hasValidDistance()){var e=this.drawElement(this.activeDrawing);t&&(e.id(this.activeDrawing.id),e.data("createdby",this.wbController.getMyId()),this.applyStyles(e)),e.data("modifiedby",this.wbController.getMyId()),this.setDrawingElement(e)}},t.prototype.drawElement=function(t){return t.element},t.prototype.hasValidDistance=function(){var t=Math.pow(this.activeDrawing.lastX-this.activeDrawing.startX,2),e=Math.pow(this.activeDrawing.lastY-this.activeDrawing.startY,2),o=Math.sqrt(t+e);return!this.minDistance||0===this.minDistance||o>=this.minDistance},t.prototype.hasDrawingStarted=function(){return!n.isNil(this.activeDrawing.startX)&&!n.isNil(this.activeDrawing.startY)},t.prototype.completeDrawing=function(){this.finalizeDrawing(),this.updateDrawCoords(),n.isNil(this.activeDrawing.element)||(a.debug("completeDrawing",this.activeDrawing),this.drawController.sendItem(this.activeDrawing.element)),this.activeDrawing={}},t.prototype.initDrawing=function(t,e,o){return void 0===o&&(o=!1),{startX:t,startY:e,shiftKey:o,element:null,id:l.uuid()}},t.prototype.finalizeDrawing=function(){this.activeDrawing=i({},this.activeDrawing,{final:!0})},t.prototype.setDrawingElement=function(t){this.activeDrawing=i({},this.activeDrawing,{element:t})},t.prototype.updateDrawing=function(t,e,o){void 0===o&&(o=!1),this.activeDrawing=i({},this.activeDrawing,{lastX:t,lastY:e,shiftKey:o})},t.prototype.applyStyles=function(t){var e=this.wbController.strokeColor,o=this.wbController.strokeWidth;t.stroke({color:e,width:o}).fill("none")},t}();e.BaseDraw=c},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/ellipse-tool.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/base-draw.js"),s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.minSize=2,e.minDistance=10,e}return i(e,t),e.prototype.drawElement=function(t){var e,o,i=s.isNil(t.element)?this.svgDraw.ellipse().center(t.startX,t.startY):t.element;if(t.shiftKey){var n=Math.pow(Math.abs(t.startX-t.lastX),2),r=Math.pow(Math.abs(t.startY-t.lastY),2);e=o=Math.sqrt(n+r)}else e=Math.abs(t.startX-t.lastX),o=Math.abs(t.startY-t.lastY);return e=Math.max(e,this.minSize),o=Math.max(o,this.minSize),i.attr({rx:e,ry:o}),i},e}(n.BaseDraw);e.EllipseTool=r},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/event-helpers.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/lodash/lodash.js");e.accept=function(t,o){return e.acceptEvent(o)},e.passthroughEvent=function(t){return!0},e.acceptEvent=function(t){return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),!1},e.isMainButton=function(t){return void 0!==t.buttons?1===t.buttons:void 0!==t.which?1===t.which:0===t.button},e.eventXY=function(t){var e=t.touches&&t.touches.length>0,o=e?t.touches[0]:t;return{x:o.clientX,y:o.clientY}},e.isMultiTouch=function(t){return!i.isNil(t.touches)&&t.touches.length>1};var n;e.resetAndCallback=function(t){clearTimeout(n),n=null,t&&t()},e.detectSingleOrDoubleTap=function(t,o){n?e.resetAndCallback(o):n=setTimeout(function(){return e.resetAndCallback(t)},400)},e.passive={passive:!0},e.notpassive={passive:!1},e.isInvalidTouch=function(t){return t.type.startsWith("touch")&&e.isMultiTouch(t)},e.isInvalidMouse=function(t){return t.type.startsWith("mouse")&&!e.isMainButton(t)},e.eventTargetId=function(t){var e=t.target,o=void 0===e?{}:e,i=o.id;return void 0===i?null:i}},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/freehand-tool.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/base-draw.js"),r=o("../../../../workspace/node_modules/lodash/lodash.js"),a=o("../../../../workspace/node_modules/fit-curve/lib/fit-curve.js"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MIN_SIMPLIFY=2,e.SIMPLIFY_POINTS=100,e.ERROR_TOLERANCE=.2,e.minDistance=2,e}return i(e,t),e.prototype.newPath=function(t){this.points=[[t.startX,t.startY],[t.lastX,t.lastY]],this.lastSimplify=0;var e=this.svgDraw.path();return e.M({x:t.startX,y:t.startY}),e.L({x:t.lastX,y:t.lastY}),e},e.prototype.updatePath=function(t){if(!this.validDistanceFromLast(t))return t.element;var e=t.element;return this.points.push([t.lastX,t.lastY]),e.L({x:t.lastX,y:t.lastY}),this.storeLastXY(t),e},e.prototype.storeLastXY=function(t){this.lastX=t.lastX,this.lastY=t.lastY},e.prototype.validDistanceFromLast=function(t){return void 0===this.lastX||void 0===this.lastY||Math.sqrt(Math.pow(t.lastX-this.lastX,2)+Math.pow(t.lastY-this.lastY,2))>this.minDistance},e.prototype.drawElement=function(t){var e=r.isNil(t.element)?this.newPath(t):this.updatePath(t),o=this.points.length-this.lastSimplify;return(t.final&&o>this.MIN_SIMPLIFY||o>this.SIMPLIFY_POINTS)&&(this.simplifyPointsToPath(this.points,t.element),this.lastSimplify=this.points.length),e},e.prototype.simplifyPointsToPath=function(t,e){var o=e,i=(new Date).getTime(),s=a(t,this.ERROR_TOLERANCE);o.update(!0),o.clearPath();for(var r=!0,l=0,c=s;l<c.length;l++){var h=c[l];r?(o.M({x:h[0][0],y:h[0][1]}),o.L({x:h[3][0],y:h[3][1]}),r=!1):o.C({x:h[1][0],y:h[1][1]},{x:h[2][0],y:h[2][1]},{x:h[3][0],y:h[3][1]})}o.update(!1),o.redraw();var d=(new Date).getTime()-i;n.info("simplify|"+d+"ms|"+t.length+" to "+o.getSegmentCount()+" points|")},e}(s.BaseDraw);e.FreeHandTool=l},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/line-tool.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/base-draw.js"),s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.minDistance=10,e}return i(e,t),e.prototype.newLine=function(t){return this.svgDraw.line(t.startX,t.startY,t.lastX,t.lastY)},e.prototype.newPlot=function(t){return t.element.plot(t.startX,t.startY,t.lastX,t.lastY),t.element},e.prototype.drawElement=function(t){return s.isNil(t.element)?this.newLine(t):this.newPlot(t)},e}(n.BaseDraw);e.LineTool=r},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/pointer-tool.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/lodash/lodash.js"),n=o("../../../../workspace/node_modules/svg.js/dist/svg.js"),s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/event-helpers.js"),r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/svg-helpers.js");e.HAND_ICON="M5.7 11c-.5-1.4-2-2-3.4-1.5s-2 1.9-1.6 3.3l3 7c.9 1.7 3.1 2.7 4.1 2.6h9.3c3.1 0 5.6-2.4 5.6-5.5v-5.3c0-1.2-.9-2.1-2-2.1h-.2c-1.2 0-2 1-2 2.1v-.9c0-1.2-.9-2.1-2-2.1h-.2c-1.2 0-2 1-2 2.1v.5-.4c0-1.2-.9-2.1-2-2.1H12c-1.2 0-2 1-2 2.2v.4-8c0-1.2-.9-2.1-2-2.1h-.2c-1.2 0-2 1-2 2.1v8.9";var a=200,l=function(t){return"pointer-"+t},c=function(){function t(t,e,o){this.svgDraw=t,this.controller=e,this.drawController=o,this.throttledUpdate=i.throttle(this.sendUpdate,a)}return t.prototype.onUpdate=function(){},t.prototype.activate=function(){var t=this.svgDraw;t.on("mousemove",this.onMove,this),t.on("touchmove",this.onMove,this,s.passive)},t.prototype.deactivate=function(){this.turnOff(),this.svgDraw.off()},t.prototype.isPointerAction=function(t){var e=t.action;return"draw_pointer"===e||"update_pointer"===e||"remove_pointer"===e},t.prototype.processPointerUpdate=function(t){if(!this.isUpdateForMyPointer(t)){var e=t.point,o=t.uid,i=t.action;this.clearPointerForUID(o),"remove_pointer"!==i&&this.drawPointer(e.x,e.y,l(o))}},t.prototype.clearPointerForUID=function(t){var e=n.get(l(t));e&&e.remove()},t.prototype.initPointer=function(t){var e=t.x,o=t.y,i=e-5,n=this.drawPointer(i,o,l(this.controller.getMyId()));this.drawController.cursor="none",this.sendUpdate(n,"draw_pointer")},t.prototype.drawPointer=function(t,o,i){return this.svgDraw.path(e.HAND_ICON).id(i).data("type","pointer").stroke({color:"black",width:1}).fill("white").move(t,o)},t.prototype.updatePointer=function(t,e){var o=e.x,i=e.y,n=o-5;t.move(n,i),this.throttledUpdate(t,"update_pointer")},t.prototype.onMove=function(t){var e=this.getMyPointer(),o=r.svgPointForEvent(s.eventXY(t),this.svgDraw.native());return s.passthroughEvent(i.isNil(e)?this.initPointer(o):this.updatePointer(e,o))},t.prototype.sendUpdate=function(t,e){var o={x:t.x(),y:t.y()};this.drawController.sendPointerUpdate(o,e)},t.prototype.reset=function(){var t=this.getMyPointer();t&&t.remove(),this.drawController.cursor="auto"},t.prototype.turnOff=function(){var t=this.getMyPointer();t&&(this.sendUpdate(t,"remove_pointer"),this.reset())},t.prototype.isUpdateForMyPointer=function(t){return t.uid===this.controller.getMyId()},t.prototype.getMyPointer=function(){return n.get(l(this.controller.getMyId()))},t}();e.PointerTool=c},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/rectangle-tool.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/base-draw.js"),s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=function(t){return 0===t?0:t<0?-1:1},a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.minDistance=10,e}return i(e,t),e.prototype.drawElement=function(t){var e,o,i=s.isNil(t.element)?this.svgDraw.rect():t.element,n=t.startX,a=t.lastX,l=t.startY,c=t.lastY;if(t.shiftKey){var h=Math.max(Math.abs(a-n),Math.abs(c-l),1);a=n+r(a-n)*h,c=l+r(c-l)*h}return n>a&&(e=[a,n],n=e[0],a=e[1]),l>c&&(o=[c,l],l=o[0],c=o[1]),i.move(n,l).size(Math.max(a-n,1),Math.max(c-l,1)),i},e}(n.BaseDraw);e.RectangleTool=a},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/select-tool.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__assign||Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++){e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t});Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/svg.js/dist/svg.js"),r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/event-helpers.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/svg-helpers.js");e.MAX_POINT_SIZE=25,e.RESIZE_MIN=4;var l=function(){function t(t,e,o){this.svgDraw=t,this.controller=e,this.drawController=o,this.selectedItem=null,this.selectedItemCheckpoint=null,this.resizeCheckpoint=null,this.hoverItem=null,this.dragOrResizeActive=!1}return t.prototype.initTool=function(t,e){this.textTool=e,this.svgDiv=t},t.prototype.onUpdate=function(t){if(this.selectedItem&&this.selectedItem.attr("id")===t){this.selectionOff();var e=s.get(t);e&&this.selectionOn(e)}},t.prototype.onSize=function(){if(this.selectedItem){var t=this.selectedItem;this.selectionOff(),this.selectionOn(t)}},t.prototype.activate=function(){var t=this,e=this.svgDraw;e.on("mousedown",this.onDown,this),e.on("mousemove",this.onMove,this),e.on("touchstart",this.onTouchStart,this,r.notpassive),e.on("dblclick",this.checkTextEdit,this),this.svgDiv.on("keydown",function(e){return t.onKeyDown(e)}),this.drawController.focusCanvas()},t.prototype.deactivate=function(){this.selectionOff(),this.hoverOff(),this.svgDraw.off(),this.svgDiv.off(),this.dragOrResizeActive=!1},t.prototype.onDown=function(t){if(!r.isMainButton(t))return r.passthroughEvent();var e=this.mouseHitTest(t);return this.toggleItemSelect(e,t),e?r.acceptEvent(t):r.passthroughEvent()},t.prototype.onMove=function(t){if(this.dragOrResizeActive)return r.passthroughEvent();var e=this.mouseHitTest(t);return this.toggleItemHover(e),e?r.acceptEvent(t):r.passthroughEvent()},t.prototype.onTouchStart=function(t){if(this.dragOrResizeActive)return this.isTextElement(this.selectedItem)?(this.textElementTouch(this.selectedItem),r.acceptEvent(t)):r.passthroughEvent();var e=this.touchHitTest(t);return n.isNil(e)?r.passthroughEvent(this.toggleItemSelect(e,t)):this.isTextElement(e)?r.accept(this.textElementTouch(e),t):r.accept(this.toggleItemSelect(e,t),t)},t.prototype.textElementTouch=function(t){var e=this,o=function(){return e.editText(t)},i=function(){return e.toggleItemSelect(t,event)};r.detectSingleOrDoubleTap(i,o)},t.prototype.editText=function(t){var e=this;this.selectionOff(),this.textTool.editExisting(t,function(){return e.selectionOn(t)})},t.prototype.toggleItemSelect=function(t,e){t?this.selectionOn(t,e):this.selectionOff()},t.prototype.toggleItemHover=function(t){t?this.hoverOn(t):this.hoverOff()},t.prototype.buildSelectionOptions=function(t){var o=this.controller.opt.touchDevice?50:10,i=this.controller.opt.touchDevice?18:10,n=(this.svgDraw.viewbox()||{}).zoom,s=void 0===n?1:n;if(s<1){var r=i*(1/s);i=r<=e.MAX_POINT_SIZE?r:e.MAX_POINT_SIZE}return{pointSize:i,radius:o,deepSelect:!0,pointsExclude:this.isTextElement(t)?["t","r","b","l"]:[]}},t.prototype.startDragOrResize=function(){this.selectedItemCheckpoint=a.captureElementCheckpoint(this.selectedItem),this.dragOrResizeActive=!0},t.prototype.handleResize=function(){if(this.selectedItem&&this.isTextElement(this.selectedItem)){this.selectedItem.attr("font-size")<=e.RESIZE_MIN&&(this.resizeCheckpoint||(this.resizeCheckpoint=a.captureElementCheckpoint(this.selectedItem)),this.selectedItem.attr("font-size",e.RESIZE_MIN),this.selectedItem.move(this.resizeCheckpoint.x,this.resizeCheckpoint.y))}},t.prototype.endDragOrResize=function(){this.dragOrResizeActive=!1,this.resizeCheckpoint=null,a.isElementDirty(this.selectedItem,this.selectedItemCheckpoint)&&this.sendItem()},t.prototype.onKeyDown=function(t){if(n.isNil(this.selectedItem)||"Backspace"!==t.key&&"Delete"!==t.key)return r.passthroughEvent();var e=this.selectedItem;return this.selectionOff(),this.drawController.deleteItem(e),r.acceptEvent(t)},t.prototype.selectionOn=function(t,e){t!==this.selectedItem&&(this.selectionOff(),t.selectize(!1).selectize(this.buildSelectionOptions(t)).resize().draggable(),this.selectedItem=t,this.selectedItemCheckpoint=null,this.resizeCheckpoint=null,this.selectionEventHandlers(t)),e&&t.remember("_draggable").start(e)},t.prototype.selectionEventHandlers=function(t){var e=this;t.on("touchstart",function(t){return e.onTouchStart(t)},this,r.notpassive),t.on("dragstart",function(){return e.startDragOrResize()}),t.on("dragend",function(){return e.endDragOrResize()}),t.on("resizestart",function(){return e.startDragOrResize()}),t.on("resizing",function(){return e.handleResize()}),t.on("resizedone",function(){return e.endDragOrResize()})},t.prototype.checkTextEdit=function(t){this.isTextElement(this.selectedItem)?r.accept(this.editText(this.selectedItem),t):r.passthroughEvent()},t.prototype.selectionOff=function(){this.textTool.completeEdit(),this.selectedItem&&(a.isElementDirty(this.selectedItem,this.selectedItemCheckpoint)&&this.sendItem(),this.selectedItem.selectize(!1,{deepSelect:!0}).resize("stop").draggable(!1),this.selectedItem.off(),this.selectedItem=null),this.selectedItemCheckpoint=null,this.dragOrResizeActive=!1},t.prototype.hoverOn=function(t){t!==this.hoverItem&&this.hoverOff(),t!==this.hoverItem&&t!==this.selectedItem&&(t.selectize(!1).selectize({points:!1,rotationPoint:!1}),this.hoverItem=t),this.drawController.cursor="move"},t.prototype.hoverOff=function(){if(this.hoverItem&&this.hoverItem!==this.selectedItem)try{this.hoverItem.selectize(!1)}catch(t){}this.hoverItem=null,this.drawController.cursor="auto"},t.prototype.isTextElement=function(t){var e=(t||{}).type;return"text"===(void 0===e?"":e)},t.prototype.mouseHitTest=function(t){var e={x:t.offsetX,y:t.offsetY},o=r.eventTargetId(t),n=i({},e,{targetId:o}),s=a.hitTest(n,this.svgDraw.native());return this.isSelectableElement(s)?s:null},t.prototype.touchHitTest=function(t){var e=a.svgPointForEvent(r.eventXY(t),this.svgDraw.native()),o=r.eventTargetId(t),n=i({},e,{targetId:o}),s=a.hitTest(n,this.svgDraw.native());return this.isSelectableElement(s)?s:null},t.prototype.sendItem=function(){this.drawController.sendItem(this.selectedItem,"update"),this.selectedItemCheckpoint=null},t.prototype.isSelectableElement=function(t){return!n.isNil(t)&&"pointer"!==t.data("type")},t}();e.SelectTool=l},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/svg-helpers.js":function(t,e,o){function i(t,e){var o=d.get(t.targetId);return o&&"svg"===o.type&&(o=null),u.isNil(o)?r(t,e):o}function n(t){var e=t?t.getAttribute("id"):null;return e?d.get(e):null}function s(t){var e=n(t);return e?e.position():0}function r(t,e){var o=t.x,i=t.y;if("function"!=typeof e.getIntersectionList)return null;var r=e.createSVGRect();r.x=o-3,r.y=i-3,r.width=6,r.height=6;var a=e.getIntersectionList(r,e),l=u.orderBy(a,function(t){return s(t)},["desc"]);return l.length>0?n(l[0]):null}function a(t){if(u.isNil(t))return null;var e=t.transform();return{x:t.x(),y:t.y(),h:t.height(),w:t.width(),skewX:e.skewX,skewY:e.skewY}}function l(t,o){if(u.isNil(t)||u.isNil(o))return!1;var i=t.transform();return e.isValueDirty(t.x(),o.x)||e.isValueDirty(t.y(),o.y)||e.isValueDirty(t.width(),o.w)||e.isValueDirty(t.height(),o.h)||e.isValueDirty(i.skewX,o.skewX)||e.isValueDirty(i.skewY,o.skewY)}function c(t,e){var o=t.x,i=t.y,n=e.createSVGPoint();n.x=o,n.y=i;var s=e.getScreenCTM().inverse(),r=n.matrixTransform(s);return{x:r.x,y:r.y}}function h(t,e){var o=e.createSVGPoint(),i=t.node.getCTM();o.x=t.x(),o.y=t.y();var n=o.matrixTransform(i);return{x:n.x,y:n.y}}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var d=o("../../../../workspace/node_modules/svg.js/dist/svg.js"),u=o("../../../../workspace/node_modules/lodash/lodash.js");e.hitTest=i,e.getSVGElement=n,e.elementPos=s,e.checkIntersection=r,e.captureElementCheckpoint=a,e.isValueDirty=function(t,e){return Math.abs(t-e)>1},e.isElementDirty=l,e.svgPointForEvent=c,e.screenXYForElement=h,e.getRotation=function(t){var e=(t?t.transform():{}).rotation;return void 0===e?0:e}},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/text-tool.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/lodash/lodash.js"),n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/paper-tools/bdi-util.js"),s=o("../../../../workspace/node_modules/lil-uuid/uuid.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/event-helpers.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/svg-helpers.js");e.TOP_OFFSET=2.75,e.DEFAULT_WIDTH=200,e.DEFAULT_COLOR="rgba(255, 255, 255, 0.85)",e.PLACEHOLDER="-placeholder-",e.BASE_TEXT_CSS={border:0,position:"absolute",display:"none",width:e.DEFAULT_WIDTH+"px",margin:0,padding:0},e.INPUT_ID="svg_textinput",e.INPUT_TEMPLATE='<input id="'+e.INPUT_ID+'" type="text" name="svg_textinput"/>';var c=function(){function t(t,e,o){this.svgDraw=t,this.controller=e,this.drawController=o,this.textArea=null}return t.prototype.activate=function(){var t=this.svgDraw;t.on("mousedown",this.onDown,this),t.on("touchstart",this.onDown,this,a.notpassive)},t.prototype.onUpdate=function(){},t.prototype.deactivate=function(){this.completeEdit(),this.svgDraw.off()},t.prototype.initTool=function(t){t.append(r(e.INPUT_TEMPLATE)),this.textArea=t.find("#"+e.INPUT_ID),this.textArea.css(e.BASE_TEXT_CSS)},t.prototype.onDown=function(t){i.isNil(this.editItem)||this.completeEdit();var e=l.svgPointForEvent(a.eventXY(t),this.svgDraw.native());return a.accept(this.startNewEdit(e),t)},t.prototype.textOnKeyDown=function(t){return 13===t.keyCode?(this.completeEdit(),void t.preventDefault()):27===t.keyCode?(this.cancel(),void t.preventDefault()):void 0},t.prototype.startNewEdit=function(t){var e=this.controller.opt.isRTL,o=this.createElement(t,e);this.editItem={anchorRTL:e,element:o,isNew:!0},this.setupTextBox()},t.prototype.setTextBoxStyle=function(t){var o=this.editItem.isNew?"right":"center",i=this.editItem.anchorRTL?o:"left",n=this.svgDraw.viewbox().zoom,s=void 0===n?1:n,r=t.attr("font-size")*s;this.textArea.css({height:"auto",color:t.attr("fill"),"font-family":t.attr("font-family"),"font-size":r,"font-weight":t.attr("font-weight"),"background-color":e.DEFAULT_COLOR,"text-align":i})},t.prototype.setupTextBox=function(){var t=this.editItem,e=l.screenXYForElement(t.element,this.svgDraw.native());t.element.hide();var o=t.isNew?this.controller.opt.inputLabelNew:this.controller.opt.inputLabelEdit,i=t.anchorRTL?"rtl":"ltr";this.textArea.attr({dir:i,"aria-label":o});var n=t.element.data("text");this.textArea.val(n),this.setTextBoxStyle(t.element);var s=this.getTextBoxPosition(t,e.x,e.y);this.textArea.css(s),this.setTextBoxTransform(t),this.textAreaEventHandlers(e),this.textArea.show(),this.textArea.focus()},t.prototype.textAreaEventHandlers=function(t){var e=this;this.textArea.keyup(function(){return e.adjustWidth(e.editItem,t)}),this.textArea.keydown(function(t){return e.textOnKeyDown(t)}),this.textArea.focusout(function(){return e.completeEdit()})},t.prototype.adjustWidth=function(t,e){if(!i.isNil(t)){var o=this.getTextBoxPosition(t,e.x,e.y);this.textArea.css({width:o.width,left:o.left})}},t.prototype.getTextBoxPosition=function(t,o,i){var n=this.svgDraw.viewbox().zoom,s=void 0===n?1:n,r=this.controller.measureText(this.textArea.get(0),this.textArea.val()),a=r<e.DEFAULT_WIDTH?e.DEFAULT_WIDTH:r,l=t.isNew?a:a/2;return{left:t.anchorRTL?o-l:o,width:a,top:i-e.TOP_OFFSET*s}},t.prototype.setTextBoxTransform=function(t){var e="rotate("+l.getRotation(t.element)+"deg)",o=t.anchorRTL?"50 50":"0 0";this.textArea.css({transform:e,"transform-origin":o})},t.prototype.editExisting=function(t,e){if(!this.editItem||this.editItem.element!==t){var o=t.y(),i="rtl"===t.data("dir");this.editItem={element:t,checkpointY:o,anchorRTL:i,isNew:!1,onComplete:e},this.adjustX(this.editItem,"start"),this.setupTextBox()}},t.prototype.completeEdit=function(){if(!i.isNil(this.editItem)){var t=this.editItem,o=this.textArea.val();if(i.isEmpty(o)||o===e.PLACEHOLDER)return this.endEditMode();var s=t.anchorRTL?n.add_rle(o):n.add_lre(o);t.element.data("text",o).plain(s).style({"white-space":"pre"}),t.isNew||t.element.data("modifiedby",this.controller.getMyId()),this.showElement(t),this.adjustX(t,"end"),this.drawController.sendItem(t.element),this.endEditMode()}},t.prototype.adjustX=function(t,e){if(t.anchorRTL){var o=t.element,i=o.bbox().w,n=void 0===i?0:i,s=t.isNew?n:n/2,r="end"===e?o.x()-s:o.x()+s;o.x(r)}},t.prototype.createElement=function(t,o){var i=t.x,n=t.y,r=this.controller.fontFamily,a=this.controller.fontWeight,l=this.controller.fontSize,c=this.controller.strokeColor;return this.svgDraw.plain(e.PLACEHOLDER).move(i,n).font({family:r,weight:a,size:l}).fill({color:c}).data("dir",o?"rtl":"ltr").data("createdby",this.controller.getMyId()).id(s.uuid())},t.prototype.cancel=function(){this.editItem&&!i.isNil(this.editItem.element.data("text"))&&(this.showElement(this.editItem),this.adjustX(this.editItem,"end")),this.endEditMode()},t.prototype.showElement=function(t){t.element.show(),i.isNil(t.checkpointY)||(t.element.y(t.checkpointY),t.checkpointY=null)},t.prototype.endEditMode=function(){var t=this.editItem.onComplete;this.editItem=null,this.textArea.hide(),this.textArea.val(""),this.textArea.off(),this.controller.contentSizer.resetInnerScroll(),this.drawController.focusCanvas(),t&&t()},t}();e.TextTool=c},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/tools.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/line-tool.js");e.LineTool=i.LineTool;var n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/freehand-tool.js");e.FreeHandTool=n.FreeHandTool;var s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/ellipse-tool.js");e.EllipseTool=s.EllipseTool;var r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/rectangle-tool.js");e.RectangleTool=r.RectangleTool;var a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/pointer-tool.js");e.PointerTool=a.PointerTool;var l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/select-tool.js");e.SelectTool=l.SelectTool;var c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation/svg-tools/text-tool.js");e.TextTool=c.TextTool,e.initTools=function(t,e,o){return{pencil:new n.FreeHandTool(t,e,o),line:new i.LineTool(t,e,o),ellipse:new s.EllipseTool(t,e,o),rectangle:new r.RectangleTool(t,e,o),pointer:new a.PointerTool(t,e,o),text:new c.TextTool(t,e,o),select:new l.SelectTool(t,e,o)}}},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/background.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/lodash/lodash.js"),n=o("../../../../workspace/node_modules/urijs/src/URI.js"),s=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),r=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/base-bg-layer.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/img-bg-layer.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/svg-bg-layer.js"),h=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/pdf-bg-layer.js"),d=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/pdf-config.js");e.getNewInstance=function(t,e){return new u(t,e)};var u=function(){function t(t,e){this.requestSeq=0,this.controller=t,d.configurePDFJS(t.opt),this.init(e)}return t.prototype.init=function(t){this.bgContainer=s('<div class="background"/>'),t.append(this.bgContainer)},t.prototype.insertLayerElem=function(t){return this.bgContainer.append(t)},t.prototype.size=function(t){if(!this.bgContainer)return void r.error("Attempt to size background element when it does not exist - init should be called before size.");this.bgContainer.css(t);var e=this.newLayer;if(this.newLayer=null,e&&e!==this.bgLayer){var o=this.bgLayer;this.bgLayer=e,this.bgLayer.size(t),this.bgLayer.show().then(function(){o&&o.remove()})}else this.newLayer=null,this.bgLayer&&this.bgLayer.size(t)},t.prototype.processUrls=function(t){var e;!i.isEmpty(t.url)||i.isEmpty(t.relativeUrl)||i.isEmpty(this.controller.baseUrl)||(e=new n(t.relativeUrl,this.controller.baseUrl+"/"),t.url=e.toString()),t.url&&i.isEmpty(t.image_ext)&&(e||(e=new n(t.url)),t.image_ext=e.suffix())},t.prototype.determineType=function(t){return i.isEmpty(t.url)?"blank":this.controller.opt.disablePDF||i.isEmpty(t.pdfUrl)?i.isEmpty(t.svgUrl)&&"image/svg+xml"!==t.pageType&&"svg"!==t.image_ext||t.disableSVGDOM?"img":"svg":"pdf"},t.prototype.handleErrorFallback=function(t,e){"pdf"===t?(e.pdfUrl=null,r.warn("Retrying by disabling PDF support."),this.load(e)):"svg"!==t||e.disableSVGDOM?(r.error("Unrecoverable error while trying to show a background."),this.controller.layerError(this.getBackgroundUpdateInfo(e))):(r.error("Error loading svg via XHR, will attempt again without XHR."),e.disableSVGDOM=!0,this.load(e))},t.prototype.createBackgroundLayer=function(t,e,o){var i={cookieValues:e.cookieValues,cookieSignature:e.cookieSignature,urlCallback:this.controller.opt.urlCallback};switch(t){case"img":return new l.ImageBackgroundLayer(this.controller,this,e,i,o);case"svg":return new c.SvgBackgroundLayer(this.controller,this,e,i,o);case"pdf":return new h.PdfBackgroundLayer(this.controller,this,e,i,o);case"blank":return new a.BaseBackgroundLayer(this.controller,this,e,i,o);default:return r.warn("Unknown bgType, using blank background:",t),new a.BaseBackgroundLayer(this.controller,this,e,i,o)}},t.prototype.getBackgroundUpdateInfo=function(t){return{contentName:t.contentName,contentId:t.uid,slideIndex:t.subSlideIndex,slideCount:t.totalSlides,slidesLoaded:t.subSlides}},t.prototype.load=function(t){var e=this;this.processUrls(t),(this.controller.opt.disableXHR||this.controller.opt.disableSVGDOM)&&(t.disableSVGDOM=!0),t.reset&&this.controller.clear(!1);var o=this.determineType(t),i=this.createBackgroundLayer(o,t,++this.requestSeq);r.info("Layer ("+o+") load set up as: "+i.requestSeq),this.controller.layerLoading(this.getBackgroundUpdateInfo(t)),i.load().then(function(o){if(i.requestSeq!==e.requestSeq)return r.info("Layer loaded, but skipping updating background, since a different background update was already in progress. ("+e.requestSeq+" vs "+i.requestSeq+")"),i.remove(),void(i=null);e.newLayer=i,e.controller.layerReady(o,e.getBackgroundUpdateInfo(t))}).catch(function(n){return i.requestSeq!==e.requestSeq?void r.info("Error detected while preparing the slide, but skipping further fallbacks, since a different  background update was already in progress. ("+e.requestSeq+" vs "+i.requestSeq+")"):i.displayed?void r.info("Error detected while preparing the slide, but skipping further fallbacks, since the slide is marked as displayed."):(r.warn("error detected while trying to prepare the "+o+" slide for display: "+n),e.handleErrorFallback(o,t),i.remove(),void(i=null))}).done()},t}();e.Background=u},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/base-bg-layer.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/q/q.js"),n=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),s=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed");e.FADE_TIME_MS=150;var r=function(){function t(t,e,o,i,n){this.layerElemInserted=!1,this._displayed=!1,this.controller=t,this.background=e,this.wbj=o,this.loaderOpts=i,this._requestSeq=n}return Object.defineProperty(t.prototype,"displayed",{get:function(){return this._displayed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestSeq",{get:function(){return this._requestSeq},enumerable:!0,configurable:!0}),t.prototype.load=function(){var t=this;return i.Promise(function(e,o,i){var r;r=t.wbj.width>0&&t.wbj.height>0?{width:t.wbj.width,height:t.wbj.height}:{width:t.controller.defaultWidth,height:t.controller.defaultHeight},n.info("setting up blank background"),t.layerElem=s("<div class='background'/>"),t.setDefaultStyle(),e(r)})},t.prototype.show=function(t){var o=this;return void 0===t&&(t=!1),i.Promise(function(i,n,s){o._displayed=!0,o.layerElemInserted||(o.background.insertLayerElem(o.layerElem),o.layerElemInserted=!0),o.layerElem.fadeIn(o.controller.opt.disableFade||t?0:e.FADE_TIME_MS,function(){i()})})},t.prototype.appendTo=function(t){t.append(this.layerElem),this.layerElemInserted=!0},t.prototype.remove=function(){this.layerElem?(this.layerElem.remove(),this.layerElem=null):n.warn("Attempt to remove layer element when it does not exist."),this.layerElemInserted=!1},t.prototype.size=function(t){this.layerElem?this.layerElem.css(t):n.warn("Attempt to size layer element when it does not exist.")},t.prototype.setDefaultStyle=function(t){return void 0===t&&(t=!1),this.layerElem.css({position:"absolute",top:"0",border:"none","background-color":"white"}).toggle(t)},t}();e.BaseBackgroundLayer=r},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/img-bg-layer.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/q/q.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/base-bg-layer.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/img-loader.js"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.load=function(){var t=this;return n.isEmpty(this.wbj.url)?s.reject("No url for ImageBackgroundLayer to load!"):(a.info("loading image: ",this.wbj.url),c.loadImgFromUrlPromise(this.wbj.url,this.loaderOpts).then(function(e){if(!e.loaded||!e.img)throw new Error("Image not loaded!");a.info("img loaded for whiteboard: ",e),t.wbj.width=e.width,t.wbj.height=e.height,n.isEmpty(t.wbj.contentName)||(e.img.alt=t.wbj.contentName);var o=r(e.img);return e.orientationCss&&o.css(e.orientationCss),e.includesRotation?(t.layerElem=r("<div class='img_background'/>"),t.imgScale=r("<div class='img_scale'></div>"),t.layerElem.append(t.imgScale),o.css({"max-width":"none"}),t.imgScale.append(o)):t.layerElem=o,t.setDefaultStyle(),{width:t.wbj.width,height:t.wbj.height}}))},e.prototype.size=function(e){if(t.prototype.size.call(this,e),this.imgScale){var o=e.width/this.wbj.width;this.imgScale.css({"transform-origin":"top left",transform:"scale("+o+")"})}},e}(l.BaseBackgroundLayer);e.ImageBackgroundLayer=h},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/pdf-bg-layer.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/lodash/lodash.js"),s=o("../../../../workspace/node_modules/q/q.js"),r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/base-bg-layer.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/img-bg-layer.js"),h=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/pdf-loader.js");o("../../../../workspace/node_modules/pdfjs-dist/web/pdf_viewer.js");var d=o("../../../../workspace/node_modules/pdfjs-dist/build/pdf.js"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.disablePDFCanvas=!1,e.pdfCanvasDisplayed=!1,e.pdfReady=!1,e}return i(e,t),e.prototype.load=function(){if(n.isEmpty(this.wbj.pdfUrl))return s.reject("No url for PdfBackgroundLayer to load!");this.controller.opt.disablePDFCanvas&&(this.disablePDFCanvas=!0),a.info("loading pdf: ",this.wbj.pdfUrl),this.layerElem=r('<div class="pdf_background" id="pdf_request_'+this.requestSeq+'"/>'),this.setDefaultStyle();var t=s.defer();return this.loadLowRes(t),this.loadPdf(t),t.promise},e.prototype.loadLowRes=function(t){var e=this;this.lowresLayer=new c.ImageBackgroundLayer(this.controller,this.background,this.wbj,this.loaderOpts,this.requestSeq);var o=!0;if(!this.disablePDFCanvas){var i=h.returnPdfFromCache(this.wbj.pdfUrl);i&&i.loaded&&i.pdfDoc&&this.wbj.subSlideIndex>0&&this.wbj.subSlideIndex<=i.pages&&(o=!1)}o&&this.lowresLayer.load().then(function(o){a.info("loaded lowresLayer"),e.displayed&&!e.disablePDFCanvas||(a.info("appending lowresLayer"),e.lowresLayer.setDefaultStyle(!0),e.lowresLayer.appendTo(e.layerElem),e.layerElemInserted||(e.background.insertLayerElem(e.layerElem),e.layerElemInserted=!0),t.resolve({width:e.wbj.width,height:e.wbj.height}),e.lastSize&&e.size(e.lastSize))}).catch(function(o){a.warn("error loading lowres image for PDF:",e.wbj.url),e.disablePDFCanvas&&t.reject("error loading lowresLayer, which is required due to disablePDFCanvas")}).done()},e.prototype.loadPdf=function(t){var e=this;h.loadPdfFromUrlPromise(this.wbj.pdfUrl,this.loaderOpts).then(function(o){o.loaded&&o.pdfDoc||t.reject("Pdf not loaded!"),(e.wbj.subSlideIndex<0||e.wbj.subSlideIndex>o.pages)&&t.reject("Slide index is out of range!"),a.info("pdf loaded for whiteboard: ",o),o.pdfDoc.getPage(e.wbj.subSlideIndex).then(function(o){e.handlePdfPageReady(t,o)},function(o){a.error("error loading pdf page:",e.wbj.subSlideIndex," from document:",e.wbj.pdfUrl),t.reject("error loading pdf page")})}).catch(function(o){a.error("error loading pdf document:",e.wbj.pdfUrl),t.reject("error loading pdf document:")}).done()},e.prototype.handlePdfPageReady=function(t,e){var o=this;if(a.info("loaded pdf for: ",this.wbj.pdfUrl),this.layerElem){this.pdfPage=e;var i=this.initViewport(e);this.wbj.width=i.width,this.wbj.height=i.height,this.loadedSlideWidth=this.wbj.width,this.background.insertLayerElem(this.layerElem),this.layerElemInserted=!0;var n=new d.PDFJS.PDFPageView({container:this.layerElem[0],id:this.wbj.subSlideIndex,renderer:"canvas",defaultViewport:i,scale:i.scale,textLayerFactory:new d.PDFJS.DefaultTextLayerFactory,removePageBorders:!0});n.setPdfPage(this.pdfPage),a.info("drawing pdf page"),n.draw().then(function(){o.handlePdfDrawComplete(t)},function(e){a.error("error detected while drawing pdf page:",o.wbj.subSlideIndex," from document:",o.wbj.pdfUrl),t.reject("error drawing pdf page")})}},e.prototype.initViewport=function(t){var e=this.controller.opt.minimumPdfWidth,o=1,i=this.pdfPage.getViewport(o);return i.width>0&&i.width<e&&(o=e/i.width,i=this.pdfPage.getViewport(o)),a.info("source document width: "+i.width+", height: "+i.height+", scale: "+o),i},e.prototype.handlePdfDrawComplete=function(t){this.layerElem.find(".canvasWrapper").hide(),this.pdfReady=!0,this.disablePDFCanvas||t.resolve({width:this.wbj.width,height:this.wbj.height}),this.lastSize&&this.size(this.lastSize)},e.prototype.remove=function(){this.lowresLayer&&this.lowresLayer.remove(),t.prototype.remove.call(this)},e.prototype.size=function(e){var o=this;if(this.lastSize=e,t.prototype.size.call(this,e),this.lowresLayer&&this.lowresLayer.size(e),this.pageElem&&0!==this.pageElem.length||(this.pageElem=this.layerElem.find(".page")),0!==this.pageElem.length){var i=e.width/(96/72*this.loadedSlideWidth);if(this.pageElem.css({"transform-origin":"top left",transform:"scale("+i+")"}),this.pdfReady&&!this.pdfCanvasDisplayed&&!this.disablePDFCanvas){var n=this.pageElem.find(".canvasWrapper");n&&n.length>0&&(this.pdfCanvasDisplayed=!0,n.fadeIn(this.controller.opt.disableFade||!this.displayed?0:l.FADE_TIME_MS,function(){o.lowresLayer&&!o.disablePDFCanvas&&(o.lowresLayer.remove(),o.lowresLayer=null)}))}}},e}(l.BaseBackgroundLayer);e.PdfBackgroundLayer=u},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/pdf-config.js":function(t,e,o){function i(t){var e=t.pdfjs,o=e&&e.workerPath?e.workerPath:null;n.PDFJS.workerSrc=o;var i=e&&e.debugEnabled?n.PDFJS.VERBOSITY_LEVELS.debug:n.PDFJS.VERBOSITY_LEVELS.errors;n.PDFJS.verbosity=i,r.isNumber(t.cacheSizePdf)&&s.setCacheSize(t.cacheSizePdf)}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/pdfjs-dist/build/pdf.js"),s=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/pdf-loader.js"),r=o("../../../../workspace/node_modules/lodash/lodash.js");e.configurePDFJS=i},"../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/svg-bg-layer.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}());Object.defineProperty(e,"__esModule",{value:!0});var n=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),s=o("../../../../workspace/node_modules/lodash/lodash.js"),r=o("../../../../workspace/node_modules/q/q.js"),a=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/base-bg-layer.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/svg-loader.js"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.load=function(){var t=this,e=this.wbj.url;return s.isEmpty(this.wbj.svgUrl)||(e=this.wbj.svgUrl),s.isEmpty(e)?r.reject("No url for SvgBackgroundLayer to load!"):(a.info("loading svg: ",e),c.loadSvgFromUrlPromise(e,this.wbj.url_base,this.wbj.stylesheetUrl,this.loaderOpts).then(function(e){if(!e.loaded||!e.svg)throw new Error("Svg not loaded!");return a.info("svg loaded for whiteboard: ",e),t.wbj.width=e.width,t.wbj.height=e.height,t.layerElem=n(e.svg),t.setDefaultStyle(),{width:t.wbj.width,height:t.wbj.height}}))},e}(l.BaseBackgroundLayer);e.SvgBackgroundLayer=h},"../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/img-loader.js":function(t,e,o){function i(t,e){void 0===e&&(e={});var o=w.getUrlWithAuthParams(t,e);if(u.isFunction(e.urlCallback))return v.info("callback for img url: ",t,o),w.urlCallbackPromise(o,void 0,e.urlCallback,!1).then(function(t){return t.isResponse?(v.error("img-loader cannot accept response data via urlCallback, use a data URI instead: ",o),p.reject("img-loader cannot accept response data via urlCallback, use a data URI instead")):i(t.returnValue)});v.info("loading img from url: ",t,o);var s={loaded:!1,width:0,height:0,orientation:0,img:null,orientationCss:null,centeredOrientationCss:null,includesRotation:!1},c=p.defer(),h=new Image;return h.crossOrigin="anonymous",h.onload=function(){v.info("Image loaded: ",t,o),s.loaded=!0,s.width=h.naturalWidth,s.height=h.naturalHeight,s.img=h;try{f.getData(h,function(){s.orientation=u.toInteger(f.getTag(this,"Orientation")),s.orientation>=5&&a()&&(s.height=h.naturalWidth,s.width=h.naturalHeight,s.includesRotation=!0),l()?(s.orientationCss=n(s.orientation,!1),s.centeredOrientationCss=n(s.orientation,!0)):r()&&(s.orientationCss=s.centeredOrientationCss={"image-orientation":"from-image"}),c.resolve(s)})}catch(t){v.error("Exception while reading EXIF data:",t),c.reject(t)}},h.onerror=function(){c.reject("image error")},h.src=o,c.promise}function n(t,e){switch(t){case 2:return{transform:"rotateY(180deg)"};case 3:return{transform:"rotate(180deg)"};case 4:return{transform:"rotate(180deg) rotateY(180deg)"};case 5:return e?{transform:"rotate(270deg) rotateY(180deg)","transform-origin":"center"}:{transform:"rotate(270deg) rotateY(180deg)","transform-origin":"top left"};case 6:return e?{transform:"rotate(90deg)","transform-origin":"center"}:{transform:"translateY(-100%) rotate(90deg)","transform-origin":"bottom left"};case 7:return e?{transform:"rotate(90deg) rotateY(180deg)","transform-origin":"center"}:{transform:"translateY(-100%) translateX(-100%) rotate(90deg) rotateY(180deg)","transform-origin":"bottom right"};case 8:return e?{transform:"rotate(270deg)","transform-origin":"center"}:{transform:"translateX(-100%) rotate(270deg)","transform-origin":"top right"};default:return null}}function s(t){return{loaded:t.loaded,width:t.width,height:t.height,orientation:t.orientation,img:t.img.cloneNode(!0),orientationCss:t.orientationCss,centeredOrientationCss:t.centeredOrientationCss,includesRotation:t.includesRotation}}function r(){return CSS.supports("image-orientation","from-image")}function a(){return!("firefox"!==j.name||!j.version.startsWith("76"))||!r()}function l(){return!r()&&!c()}function c(){var t="Mac OS"===j.os&&g();return"safari"===j.name&&("iOS"===j.os||t)}function h(t,e){if(void 0===e&&(e={}),y){var o=b.get(t);if(o)return p.when(s(o))}return i(t,e).then(function(e){return y&&b.put(t,e),s(e)})}function d(t){b.limit=t,y=t>0}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var u=o("../../../../workspace/node_modules/lodash/lodash.js"),p=o("../../../../workspace/node_modules/q/q.js"),f=o("../../../../workspace/node_modules/exif-js/exif.js"),m=o("../../../../workspace/node_modules/detect-browser/index.js"),g=o("../../../../workspace/node_modules/is-touch-device/build/index.js"),v=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),w=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/url-loader.js"),_=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/lru-cache.js"),y=!0,b=new _.LRUCache(20),j=m.detect();e.loadImgFromUrlPromise=h,e.setCacheSize=d},"../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/lru-cache.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=10,n=function(){function t(t){void 0===t&&(t=i),this._size=0,t<1&&(t=1),this._limit=t,this._keymap={}}return Object.defineProperty(t.prototype,"limit",{get:function(){return this._limit},set:function(t){for(t<1&&(t=1),this._limit=t;this._size>this._limit&&this._head;)this.remove(this._head.key)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){var o={key:t,value:e};if(this._keymap[t]=o,this._tail?(this._tail.newer=o,o.older=this._tail):this._head=o,this._tail=o,this._size===this._limit)return this.shift();this._size++},t.prototype.shift=function(){var t=this._head;return t&&(this._head.newer?(this._head=this._head.newer,this._head.older=void 0):this._head=void 0,t.newer=t.older=void 0,delete this._keymap[t.key]),t},t.prototype.get=function(t){var e=this.get_entry(t);return e?e.value:void 0},t.prototype.get_entry=function(t){var e=this._keymap[t];if(void 0!==e)return e===this._tail?e:(e.newer&&(e===this._head&&(this._head=e.newer),e.newer.older=e.older),e.older&&(e.older.newer=e.newer),e.newer=void 0,e.older=this._tail,this._tail&&(this._tail.newer=e),this._tail=e,e)},t.prototype.find=function(t){var e=this._keymap[t];return e?e.value:void 0},t.prototype.set=function(t,e){var o=this.get_entry(t);if(o){var i=o.value;return o.value=e,i}return void this.put(t,e)},t.prototype.remove=function(t){var e=this._keymap[t];if(e)return delete this._keymap[e.key],e.newer&&e.older?(e.older.newer=e.newer,e.newer.older=e.older):e.newer?(e.newer.older=void 0,this._head=e.newer):e.older?(e.older.newer=void 0,this._tail=e.older):this._head=this._tail=void 0,this._size--,e.value},t.prototype.removeAll=function(){this._head=this._tail=void 0,this._size=0,this._keymap={}},t.prototype.keys=function(){return Object.keys(this._keymap)},t.prototype.forEach=function(t,e,o){var i;if(!0===e?(o=!0,e=void 0):"object"!=typeof e&&(e=this),o)for(i=this._tail;i;)t.call(e,i.key,i.value,this),i=i.older;else for(i=this._head;i;)t.call(e,i.key,i.value,this),i=i.newer},t.prototype.toJSON=function(){for(var t=[],e=this._head;e;)t.push({key:e.key,value:JSON.stringify(e.value)}),e=e.newer;return t},t.prototype.toString=function(){for(var t="",e=this._head;e;)t+=String(e.key)+":"+e.value,(e=e.newer)&&(t+=" < ");return t},t}();e.LRUCache=n},"../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/pdf-loader.js":function(t,e,o){function i(t,e){void 0===e&&(e={});var o=d.getUrlWithAuthParams(t,e);if(a.isFunction(e.urlCallback))return h.info("callback for url: ",t,o),d.urlCallbackPromise(o,void 0,e.urlCallback,!1).then(function(t){return t.isResponse?(h.error("pdf-loader cannot accept response data via urlCallback, use a data URI instead: ",o),l.reject("pdf-loader cannot accept response data via urlCallback, use a data URI instead")):i(t.returnValue)});h.info("loading pdf from url: ",t,o);var n={loaded:!1,pages:0,pdfDoc:null},s=l.defer();return c.getDocument({url:o}).then(function(e){h.info("pdf loaded: ",t,o),n.loaded=!0,n.pages=e.numPages,n.pdfDoc=e,s.resolve(n)},function(t){h.error("Caught pdf getDocument erorr while loading ",o,", error:",t),s.reject(t)}),s.promise}function n(t){return f.get(t)}function s(t,e){if(void 0===e&&(e={}),p){var o=f.get(t);if(o)return l.when(o)}return i(t,e).then(function(e){return p&&f.put(t,e),e})}function r(t){f.limit=t,p=t>0}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var a=o("../../../../workspace/node_modules/lodash/lodash.js"),l=o("../../../../workspace/node_modules/q/q.js"),c=o("../../../../workspace/node_modules/pdfjs-dist/build/pdf.js"),h=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),d=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/url-loader.js"),u=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/lru-cache.js"),p=!0,f=new u.LRUCache(5);e.returnPdfFromCache=n,e.loadPdfFromUrlPromise=s,e.setCacheSize=r},"../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/svg-loader.js":function(t,e,o){function i(t,e,o){return void 0===o&&(o={}),v.urlLoaderPromise(t.getAttribute("href"),"text",o).then(function(o){var i=document.createElement("style");i.type="text/css",i.appendChild(document.createTextNode(o)),e.insertBefore(i,t),e.removeChild(t)})}function n(t,e,o,n){void 0===n&&(n={});for(var s,r=t.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","link"),a=[],l=r.length-1;l>=0;l--){s=r[l];var c=s.parentNode;if("stylesheet"===s.getAttribute("rel")&&"text/css"===s.getAttribute("type")){var h,d=s.getAttribute("href");if(o&&"stylesheet.css"===d)h=o;else{h=new f(d).absoluteTo(e)}g.debug("Updating link: ",d,h),s.setAttribute("href",h),a.push(p.fcall(i,s,c,n))}}return a}function s(t){for(var e,o=t.getElementsByTagName("use"),i=o.length-1;i>=0;i--){e=o[i];var n=e.parentNode,s=e.getAttribute("xlink:href"),r=s.split("#");if(0===r[0].length){g.debug("Updating use with url fragment: ",r[1]);var a=m(t).find("#"+r[1])[0];if("symbol"!==a.tagName){for(var l=a.cloneNode(!0),c=0;c<e.attributes.length;c++){var h=e.attributes[c].name,d=e.attributes[c].value;"xlink:href"!==h&&l.setAttribute(h,d)}n.insertBefore(l,e),n.removeChild(e)}}}}function r(t,e,o,i){void 0===i&&(i={});var r={loaded:!1,width:0,height:0,svg:null};return g.info("loading svg from url: ",t),v.urlLoaderPromise(t,"xml",i).then(function(t){g.info("svg loaded: ",t),r.loaded=!0,r.svg=t.documentElement;var a=t.documentElement.attributes;r.width=parseFloat(a.width.value),isNaN(r.width)&&(r.width=0),r.height=parseFloat(a.height.value),isNaN(r.height)&&(r.height=0),t.documentElement.setAttribute("style","width: 100%; height: 100%; overflow:hidden;"),t.documentElement.setAttribute("width","100%"),t.documentElement.setAttribute("height","100%"),t.documentElement.setAttribute("focusable","false");var l=t.documentElement;document.adoptNode(l);var c=n(l,e,o,i);return s(l),p.all(c).then(function(){return r})})}function a(t,e){var o="",i="",n=t.getAttribute("class"),s=n?n.match(/crocodoc-(?!page-svg)[^\s]*/):null;s&&(i=s[0],o="collab-"+e,t.setAttribute("class",n+" "+o));for(var r=new RegExp("."+i+" ","g"),a="."+o+"."+i+" ",l=t.querySelectorAll("style"),c=0;c<l.length;++c)u.isEmpty(o)?l[c].textContent+="":l[c].textContent=l[c].textContent.replace(r,a)}function l(t,e){for(var o={clippath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],lineargradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],pattern:["fill","stroke"],radialgradient:["fill","stroke"]},i=t.querySelectorAll("defs [id]"),n=0;n<i.length;++n){var s=i[n].tagName,r=i[n].id,a=e+"_"+r;i[n].id=a;(o[s.toLowerCase()]||[]).forEach(function(e){for(var o=t.querySelectorAll("["+e+'*="#'+r+'"]'),i=0;i<o.length;++i)o[i].setAttribute(e,'url("#'+a+'")')});for(var l=t.querySelectorAll('[*|href="#'+r+'"]'),c=0;c<l.length;++c)l[c].getAttribute("xlink:href")==="#"+r&&l[c].setAttribute("xlink:href","#"+a)}}function c(t){var e=t.svg.cloneNode(!0),o=(_++).toString(36);return _>y&&(_=1),a(e,o),l(e,o),{loaded:t.loaded,width:t.width,height:t.height,svg:e}}function h(t,e,o,i){if(void 0===i&&(i={}),u.isEmpty(e)){e=new f("..").absoluteTo(t)}if(b){var n=j.get(t);if(n)return p.when(c(n))}return r(t,e,o,i).then(function(e){return b&&j.put(t,e),c(e)})}function d(t){j.limit=t,b=t>0}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var u=o("../../../../workspace/node_modules/lodash/lodash.js"),p=o("../../../../workspace/node_modules/q/q.js"),f=o("../../../../workspace/node_modules/urijs/src/URI.js"),m=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),g=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),v=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/url-loader.js"),w=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/lru-cache.js"),_=1,y=Math.pow(2,52),b=!0,j=new w.LRUCache(20);e.loadSvgFromUrlPromise=h,e.setCacheSize=d},"../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/url-loader.js":function(t,e,o){function i(t,e){if(c.isEmpty(e.cookieSignature)&&c.isEmpty(e.cookieValues))return t;var o=new d(t);o.query(e.cookieSignature);return c.forOwn(e.cookieValues,function(t,e){c.startsWith(e,"CloudFront-")?o.addQuery(e.substr("CloudFront-".length),t):c.startsWith(e,"Cookies-")?"Cookies-expires"===e&&o.addQuery("Expires",t):o.addQuery(e,t)}),o.toString()}function n(t,e,o,i){var n=h.defer();return"function"==typeof o?o(t,e,function(t,e){void 0===e&&(e=!1),n.resolve({returnValue:t,isResponse:e})},i):n.resolve({returnValue:t,isResponse:!1}),n.promise}function s(t,e){void 0===e&&(e={});var o=i(t,e);return c.isFunction(e.urlCallback)?(p.info("callback for url: ",t,o),n(o,void 0,e.urlCallback,!0).then(function(t){return t.isResponse?h.when(t.returnValue):s(t.returnValue)})):(p.info("loading from url: ",t,o),h(u.ajax({type:"GET",dataType:"text",url:o})))}function r(t,e){return"xml"===e?u.parseXML(t):"json"===e?u.parseJSON(t):t}function a(t,e,o){if(void 0===e&&(e=null),void 0===o&&(o={}),m){var i=g.get(t);if(i)return h.when(r(i,e))}return s(t,o).then(function(o){return m&&g.put(t,o),r(o,e)})}function l(t){g.limit=t,m=t>0}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var c=o("../../../../workspace/node_modules/lodash/lodash.js"),h=o("../../../../workspace/node_modules/q/q.js"),d=o("../../../../workspace/node_modules/urijs/src/URI.js"),u=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),p=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),f=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/lru-cache.js");e.getUrlWithAuthParams=i,e.urlCallbackPromise=n;var m=!0,g=new f.LRUCache(30);e.urlLoaderPromise=a,e.setCacheSize=l},"../../../../workspace/node_modules/collab-js-whiteboard/dist/platform/jinx-web/wb-jinx-web-messaging.js":function(t,e,o){o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var i=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),n=o("../../../../workspace/node_modules/lodash/lodash.js");e.getNewInstance=function(){return new s};var s=function(){function t(){}return t.prototype.initAdapter=function(t){this.adapter=t},t.prototype.initLibrary=function(){this.classroom||(this.classroom=Module.BbClassroom.getSharedClassroom(),this.wbFeature=this.classroom.getWhiteboardFeature(),this.setupListeners(),this.classroom.isConnected()&&(this.handleConnected(),this.processParticipant("",this.classroom.getRoster().getMyAddress())))},t.prototype.setViewReady=function(t){this._viewReady=t,this._viewReady&&this.checkForNewMessages()},t.prototype.draw=function(t,e,o){this.wbFeature||i.error("Library feature not set up cannot submit draw payload:",e),this.classroom.isConnected()||i.error("Can't send draw payload while not connected:",e);var n=this.updateTypeStrToVal(t);this.wbFeature.draw(n,e,o)},t.prototype.point=function(t,e){this.wbFeature||i.error("Library feature not set up cannot submit point payload:",e),this.classroom.isConnected()||i.error("Can't send point payload while not connected:",e);var o=this.updateTypeStrToVal(t);this.wbFeature.pointer(o,e)},t.prototype.updateTypeStrToVal=function(t){switch(t){case"add":return Module.BbWhiteboardUpdateType.Bb_WHITEBOARD_UPDATE_TYPE_ADD;case"remove":return Module.BbWhiteboardUpdateType.Bb_WHITEBOARD_UPDATE_TYPE_REMOVE;case"update":return Module.BbWhiteboardUpdateType.Bb_WHITEBOARD_UPDATE_TYPE_REPLACE;default:return Module.BbWhiteboardUpdateType.Bb_WHITEBOARD_UPDATE_TYPE_UNDEFINED}},t.prototype.checkForNewMessages=function(){if(this._viewReady){for(var t=this.wbFeature.getAllMessages(),e=!1,o=0;o<t.size();o++){var n=t.get(o);switch(n.getUpdateCommand()){case Module.BbWhiteboardUpdateCommand.Bb_WHITEBOARD_UPDATE_COMMAND_RESET:this.adapter.processReset(n.getPayload()),e=!0;break;case Module.BbWhiteboardUpdateCommand.Bb_WHITEBOARD_UPDATE_COMMAND_CLEAR:this.adapter.processClear();break;case Module.BbWhiteboardUpdateCommand.Bb_WHITEBOARD_UPDATE_COMMAND_POINTER:this.adapter.processPoint(n.getPayload());break;case Module.BbWhiteboardUpdateCommand.Bb_WHITEBOARD_UPDATE_COMMAND_DRAW:this.adapter.processDraw(n.getPayload()),e=!0;break;default:i.error("Unknown update command value:",n.getUpdateCommand())}n.delete()}e&&this.adapter.updatesComplete(),t.delete()}},t.prototype.handleConnected=function(){this.checkForNewMessages()},t.prototype.getParticipantUid=function(t,e){var o,i=t.getName();return n.isNil(i)||-1===i.indexOf("#")||(o=i.split("#")[1]),n.isNil(o)?e:o},t.prototype.connectionStateChanged=function(t,e){e===Module.BbClassroomConnectionState.Bb_CLASSROOM_CONNECTED_STATE.value&&this.handleConnected()},t.prototype.processParticipant=function(t,e){var o=this.classroom.getRoster().getParticipant(e);o&&o.isMe()&&(this.adapter.setMyId(this.getParticipantUid(o,e)),o.delete())},t.prototype.handlePresenceChange=function(t,e){var o=this.classroom.getRoster().getParticipant(e);if(o){var i=o.getAnnotationValueInt(Module.Bb_PARTICIPANT_PRESENCE_ANNOTATION);if(i===Module.BbParticipantPresence.Bb_PARTICIPANT_NO_CONNECTION.value||i===Module.BbParticipantPresence.Bb_PARTICIPANT_LEFT.value){var n=this.getParticipantUid(o,e);this.adapter.processParticipantExit(n)}o.delete()}},t.prototype.checkNotifications=function(){},t.prototype.setupListeners=function(){NotificationMgr.addSubscriber(Module.Bb_WHITEBOARD_MESSAGE_ARRIVED,this.checkForNewMessages,this),NotificationMgr.addSubscriber(Module.Bb_WHITEBOARD_NOTIFICATION_ARRIVED,this.checkNotifications,this),NotificationMgr.addSubscriber(Module.Bb_CLASSROOM_CONNECTION_STATE_CHANGED,this.connectionStateChanged,this),NotificationMgr.addSubscriber(Module.Bb_PARTICIPANT_JOINED,this.processParticipant,this),NotificationMgr.addSubscriber(Module.Bb_PARTICIPANT_PRESENCE_ANNOTATION_CHANGED,this.handlePresenceChange,this)},t}();e.WhiteboardACLMessaging=s},"../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-config.js":function(t,e,o){function i(t){a.isNumber(t.cacheSizeUrl)&&h.setCacheSize(e.opts.cacheSizeUrl),a.isNumber(t.cacheSizeImg)&&c.setCacheSize(e.opts.cacheSizeImg),a.isNumber(t.cacheSizeSvg)&&l.setCacheSize(e.opts.cacheSizeSvg)}function n(t){i(t);var o="function"==typeof t.urlCallback?t.urlCallback:null,n="object"==typeof t.uiCallback?t.uiCallback:null,s=null!==t.disableHiDPI?t.disableHiDPI:d.isMobileSafari();Object.assign(u,r({},e.defaultOptions,t,{urlCallback:o,uiCallback:n,disableHiDPI:s}))}function s(t,o){return void 0===o&&(o=null),"strokeWidth"===t?e.strokeWidth():"fontSize"===t?e.fontSize():a.get(u,t,o)}var r=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__assign||Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++){e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t});Object.defineProperty(e,"__esModule",{value:!0});var a=o("../../../../workspace/node_modules/lodash/lodash.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/svg-loader.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/img-loader.js"),h=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/loaders/url-loader.js"),d=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-utils.js");e.SVG_STROKE_WIDTH=2,e.PAPER_STROKE_WIDTH=2,e.SVG_FONT_SIZE=16,e.PAPER_FONT_SIZE="12pt";var u={};e.opts=u,e.defaultOptions={uiCallback:null,urlCallback:null,disableHiDPI:null,disableSVGDOM:!1,disableXHR:!1,disableFade:!1,isRTL:!1,cacheSizeUrl:null,cacheSizeImg:null,cacheSizeSvg:null,cacheSizePdf:null,touchDuringSelect:!0,touchDuringPointer:!0,inputLabelNew:"Type new text on the whiteboard and press Enter. Press Escape to cancel.",inputLabelEdit:"Edit the text on the whiteboard and press Enter. Press Escape to cancel.",containerAriaLabel:"Shared content",disablePDF:!1,svgAnnotations:!1,touchDevice:null,minimumPdfWidth:1024,defaultWidth:1024,defaultHeight:576,strokeColor:"#157afb",fontFamily:"Arial",fontWeight:"normal"},e.initOpts=n,e.strokeWidth=function(){return u.svgAnnotations?e.SVG_STROKE_WIDTH:e.PAPER_STROKE_WIDTH},e.fontSize=function(){return u.svgAnnotations?e.SVG_FONT_SIZE:e.PAPER_FONT_SIZE},e.enableTouchDevice=function(){return u.touchDevice=!0},e.toggleSVGAnnotations=function(t){return u.svgAnnotations=t},e.setStrokeColor=function(t){return u.strokeColor=t},e.getOptValue=s},"../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js":function(t,e,o){function i(t,e){void 0===e&&(e=!0),p=t,f=e}function n(t){u=t}function s(t){var e="";return d.forEach(t,function(t){if(e.length&&(e+=" "),d.isObject(t)){var o="";try{o=""+t,e+=JSON.stringify(t)}catch(t){e+="(cannot stringify "+o+": "+t+")"}}else e+=t}),e}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u){var o=["%c "+t[0],"background: #F2FA7C; color: #000000"];console.log.apply(console,o.concat(t.slice(1)))}p&&(f?p.log(s(t)):p.log.apply(p,t))}function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u){var o=["%c "+t[0],"background: #5EEE84; color: #000000"];console.info.apply(console,o.concat(t.slice(1)))}p&&(f?p.info(s(t)):p.info.apply(p,t))}function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u){var o=["%c "+t[0],"background: #F2A54E; color: #000000"];console.warn.apply(console,o.concat(t.slice(1)))}p&&(f?p.warn(s(t)):p.warn.apply(p,t))}function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u){var o=["%c "+t[0],"background: #EC5151; color: #000000"];console.error.apply(console,o.concat(t.slice(1)))}p&&(f?p.error(s(t)):p.error.apply(p,t))}function h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(u){var o=["%c "+t[0],"background: #6FA0F6; color: #000000"];console.debug.apply(console,o.concat(t.slice(1)))}p&&(f?p.debug(s(t)):p.debug.apply(p,t))}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0});var d=o("../../../../workspace/node_modules/lodash/lodash.js"),u=!1,p=null,f=!1;e.registerLogObject=i,e.setInternalLogging=n,e.log=r,e.info=a,e.warn=l,e.error=c,e.debug=h},"../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-utils.js":function(t,e,o){function i(t){var e=[0,""];t=String(t);var o=parseFloat(t);return e[0]=o,e[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",e}function n(t,e){void 0===e&&(e=!1);var o=t;return o.event&&(o=o.event),o.which<=1&&(e||(o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()),!0)}function s(){return(null!==navigator.userAgent.match(/Safari/)||null!==navigator.userAgent.match(/AppleWebKit/))&&null===navigator.userAgent.match(/Chrome/)}function r(){return null!==navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&s()}o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");Object.defineProperty(e,"__esModule",{value:!0}),e.parseUnit=i,e.buttonAllowed=n,e.isSafari=s,e.isMobileSafari=r,e.hand_icon="M5.7 11c-.5-1.4-2-2-3.4-1.5s-2 1.9-1.6 3.3l3 7c.9 1.7 3.1 2.7 4.1 2.6h9.3c3.1 0 5.6-2.4 5.6-5.5v-5.3c0-1.2-.9-2.1-2-2.1h-.2c-1.2 0-2 1-2 2.1v-.9c0-1.2-.9-2.1-2-2.1h-.2c-1.2 0-2 1-2 2.1v.5-.4c0-1.2-.9-2.1-2-2.1H12c-1.2 0-2 1-2 2.2v.4-8c0-1.2-.9-2.1-2-2.1h-.2c-1.2 0-2 1-2 2.1v8.9"},"../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard.js":function(t,e,o){var i=(o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js"),this&&this.__assign||Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++){e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}),n=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))(function(n,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):new o(function(e){e(t.value)}).then(r,a)}l((i=i.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function o(t){return function(e){return i([t,e])}}function i(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,s&&(r=2&o[0]?s.return:o[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,o[1])).done)return r;switch(s=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,s=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){l.label=o[1];break}if(6===o[0]&&l.label<r[1]){l.label=r[1],r=o;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(o);break}r[2]&&l.ops.pop(),l.trys.pop();continue}o=e.call(t,l)}catch(t){o=[6,t],s=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var n,s,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0}),o("../../../../workspace/node_modules/custom-event-polyfill/polyfill.js");var r=o("../../../../workspace/node_modules/jquery/dist/jquery.js-exposed"),a=o("../../../../workspace/node_modules/lodash/lodash.js"),l=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/content-sizer.js"),c=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-log.js"),h=o("../../../../workspace/node_modules/collab-js-whiteboard/dist/whiteboard-config.js"),d=function(){function t(){this.wbDom={outer:null,container:null,measureDiv:null},this.wbLayers={background:null,annotations:{}},this._toolsEnabled=!0,this._tool="none",this._mode="pencil",this._baseUrl="",this._contentSizer=l.ContentSizer.getNewInstance()}return t.prototype.teardown=function(){c.debug("Tearing down wb controller."),this._contentSizer&&this._contentSizer.teardown(),this.adapter&&this.adapter.initProcessor(void 0)},t.prototype.measureText=function(t,e){var o=this.wbDom.measureDiv.style,i=getComputedStyle(t);o.position="absolute",o.visibility="hidden",o["font-family"]=i["font-family"],o["font-size"]=i["font-size"],o["font-weight"]=i["font-weight"],this.wbDom.measureDiv.textContent=e.replace(/\s/g," ");var n=document.createElement("span");n.textContent=".",this.wbDom.measureDiv.appendChild(n);var s=n.offsetLeft;return this.wbDom.measureDiv.removeChild(n),s},t.prototype.init=function(t,e,o){this.adapter=t,h.initOpts(o);var i=r(e);this.isValidDOM(i)?(this.initWb(i),r(window).one("touchstart",function(){return h.enableTouchDevice()})):c.error("wbController: invalid DOM or already initialized")},t.prototype.isValidDOM=function(t){return 1===t.length&&0===t.find(".canvas_container_outer").length},t.prototype.initWb=function(t){return n(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return this.wbDom=this.initWbDom(t),e=this,[4,this.loadLayers()];case 1:return e.wbLayers=o.sent(),this.toggleActiveAnnotationClass(),this.initContentSizer(),this.allAnnotations().forEach(function(t){return t.redraw()}),this.adapter.initProcessor(this),this.uiCallback("wbReady"),[2]}})})},t.prototype.initWbDom=function(t){t.empty(),t.html('<div class="canvas_container_outer"><div class="canvas_container" role="region"></div></div>');var e=t.find(".canvas_container_outer"),o=t.find(".canvas_container");o.css({"touch-action":"none"}),o.attr("aria-label",h.getOptValue("containerAriaLabel"));var i=document.createElement("div");return i.id="wb_measurediv",i.style.visibility="hidden",i.style.position="absolute",o.get(0).appendChild(i),{outer:e,container:o,measureDiv:i}},t.prototype.sizeContents=function(t){this.wbLayers.background.size(t),this.allAnnotations().forEach(function(e){return e.size(t)})},t.prototype.getMyId=function(){return a.toString(this.adapter.getMyId())},Object.defineProperty(t.prototype,"baseUrl",{get:function(){return this._baseUrl},set:function(t){this._baseUrl=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opt",{get:function(){return h.opts},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return h.getOptValue("fontFamily")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return h.getOptValue("fontSize")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return h.getOptValue("fontWeight")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeColor",{get:function(){return h.getOptValue("strokeColor")},set:function(t){h.setStrokeColor(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return h.getOptValue("strokeWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultWidth",{get:function(){return h.getOptValue("defaultWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultHeight",{get:function(){return h.getOptValue("defaultHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentSizer",{get:function(){return this._contentSizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toolsEnabled",{get:function(){return this._toolsEnabled},set:function(t){this._toolsEnabled=t,this.setTool(this._tool,this._mode)},enumerable:!0,configurable:!0}),t.prototype.layerReady=function(t,e){this.allAnnotations().forEach(function(e){return e.setBackgroundSize(t)}),this._contentSizer.updateContentSize(t.width,t.height,!0),this._contentSizer.resetScroll(),this.uiCallback("backgroundUpdated",e)},t.prototype.layerError=function(t){this.uiCallback("backgroundError",t)},t.prototype.layerLoading=function(t){this.uiCallback("backgroundLoading",t)},t.prototype.setTool=function(t,e){this._tool=t,this._mode=e;var o=this.defaultAnnotationLayer().setTool(this._toolsEnabled,t,e);this._contentSizer.enableTouchEvents(o)},t.prototype.processUpdate=function(t){var e=this.getLayerForAction(t);this.isAnnotationLayerChangeRequired(e),c.info("wbController|processUpdate|"+e,JSON.stringify(t)),"background"===e?this.wbLayers.background.load(t):this.wbLayers.annotations[e].processUpdate(t)},t.prototype.getLayerForAction=function(t){var e=(t||{}).layer,o=void 0===e?"paper":e;return"background"===t.action&&(o="background"),"remove_pointer"===t.action&&(o=h.getOptValue("svgAnnotations")?"svg":"paper"),o},t.prototype.isAnnotationLayerChangeRequired=function(t){"svg"!==t||h.getOptValue("svgAnnotations")||(h.toggleSVGAnnotations(!0),this.toggleActiveAnnotationClass()),"paper"===t&&h.getOptValue("svgAnnotations")&&(h.toggleSVGAnnotations(!1),this.toggleActiveAnnotationClass())},t.prototype.clear=function(t){void 0===t&&(t=!0),this.allAnnotations().forEach(function(t){return t.clear()}),t&&this.allAnnotations().forEach(function(t){return t.redraw()})},t.prototype.reset=function(t){void 0===t&&(t=!0),this.wbLayers.background.load({action:"background",reset:!0}),t&&this.allAnnotations().forEach(function(t){return t.redraw()})},t.prototype.updatesComplete=function(){this.allAnnotations().forEach(function(t){return t.redraw()})},t.prototype.send=function(t,e,o){this.adapter.send(t,e,o)},t.prototype.loadLayers=function(){return n(this,void 0,void 0,function(){var t,e,i,n,r,a;return s(this,function(s){switch(s.label){case 0:return[4,Promise.resolve().then(function(){return o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/background/background.js")})];case 1:return t=s.sent(),e=t.getNewInstance(this,this.wbDom.container),this.shouldLoadSVGLayer()?[4,this.initAnnotationLayer("svg")]:[3,3];case 2:return n=s.sent(),[3,4];case 3:n=null,s.label=4;case 4:return i=n,this.shouldLoadPaperLayer()?[4,this.initAnnotationLayer("paper")]:[3,6];case 5:return a=s.sent(),[3,7];case 6:a=null,s.label=7;case 7:return r=a,[2,{background:e,annotations:{svg:i,paper:r}}]}})})},t.prototype.initContentSizer=function(){var t=this.defaultAnnotationLayer().maxHeight,e=this.defaultAnnotationLayer().maxWidth,o=this.defaultAnnotationLayer().eventObject,n=i({},h.opts,{maxHeight:t,maxWidth:e,sizeCallback:this});this._contentSizer.init(this.wbDom.outer,this.wbDom.container,o,n)},t.prototype.initAnnotationLayer=function(t){return n(this,void 0,void 0,function(){var e;return s(this,function(i){switch(i.label){case 0:return[4,Promise.resolve().then(function(){return o("../../../../workspace/node_modules/collab-js-whiteboard/dist/layers/annotation recursive ^\\.\\/.*\\-layer$")("./"+t+"-layer")})];case 1:return e=i.sent(),[2,e.getNewInstance(this,this.wbDom.container)]}})})},t.prototype.defaultAnnotationLayer=function(){var t=h.getOptValue("svgAnnotations",!1)?"svg":"paper";return this.wbLayers.annotations[t]},t.prototype.toggleActiveAnnotationClass=function(){var t=h.getOptValue("svgAnnotations",!1)?"svg":"paper";this.wbDom.container.removeClass("paper").removeClass("svg").addClass(t)},t.prototype.allAnnotations=function(){return a.filter(a.values(this.wbLayers.annotations),function(t){return!a.isNil(t)})},t.prototype.shouldLoadPaperLayer=function(){return!h.getOptValue("svgAnnotations",!1)||h.getOptValue("svgPaperDualAnnotations",!1)},t.prototype.shouldLoadSVGLayer=function(){return h.getOptValue("svgAnnotations",!1)||h.getOptValue("svgPaperDualAnnotations",!1)},t.prototype.uiCallback=function(t,e){var o=a.get(h.opts,"uiCallback."+t);if("function"==typeof o)try{o(e)}catch(e){c.error("ui callback error "+t+": ",e)}},t.getNewInstance=function(){return new t},t}();e.Whiteboard=d},"../../../../workspace/node_modules/collab-js-whiteboard/node_modules/hammerjs/hammer.js":function(t,e,o){var i;o("../../../../workspace/node_modules/css-element-queries/src/ResizeSensor.js");/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(n,s,r,a){"use strict";function l(t,e,o){return setTimeout(p(t,o),e)}function c(t,e,o){return!!Array.isArray(t)&&(h(t,o[e],o),!0)}function h(t,e,o){var i;if(t)if(t.forEach)t.forEach(e,o);else if(t.length!==a)for(i=0;i<t.length;)e.call(o,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(o,t[i],i,t)}function d(t,e,o){var i="DEPRECATED METHOD: "+e+"\n"+o+" AT \n";return function(){var e=new Error("get-stack-trace"),o=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=n.console&&(n.console.warn||n.console.log);return s&&s.call(n.console,i,o),t.apply(this,arguments)}}function u(t,e,o){var i,n=e.prototype;i=t.prototype=Object.create(n),i.constructor=t,i._super=n,o&&ft(i,o)}function p(t,e){return function(){return t.apply(e,arguments)}}function f(t,e){return typeof t==vt?t.apply(e?e[0]||a:a,e):t}function m(t,e){return t===a?e:t}function g(t,e,o){h(y(e),function(e){t.addEventListener(e,o,!1)})}function v(t,e,o){h(y(e),function(e){t.removeEventListener(e,o,!1)})}function w(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function _(t,e){return t.indexOf(e)>-1}function y(t){return t.trim().split(/\s+/g)}function b(t,e,o){if(t.indexOf&&!o)return t.indexOf(e);for(var i=0;i<t.length;){if(o&&t[i][o]==e||!o&&t[i]===e)return i;i++}return-1}function j(t){return Array.prototype.slice.call(t,0)}function k(t,e,o){for(var i=[],n=[],s=0;s<t.length;){var r=e?t[s][e]:t[s];b(n,r)<0&&i.push(t[s]),n[s]=r,s++}return o&&(i=e?i.sort(function(t,o){return t[e]>o[e]}):i.sort()),i}function T(t,e){for(var o,i,n=e[0].toUpperCase()+e.slice(1),s=0;s<mt.length;){if(o=mt[s],(i=o?o+n:e)in t)return i;s++}return a}function x(){return kt++}function P(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||n}function S(t,e){var o=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){f(t.options.enable,[t])&&o.handler(e)},this.init()}function E(t){var e=t.options.inputClass;return new(e||(Pt?B:St?H:xt?V:q))(t,I)}function I(t,e,o){var i=o.pointers.length,n=o.changedPointers.length,s=e&It&&i-n==0,r=e&(Ct|Dt)&&i-n==0;o.isFirst=!!s,o.isFinal=!!r,s&&(t.session={}),o.eventType=e,O(t,o),t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}function O(t,e){var o=t.session,i=e.pointers,n=i.length;o.firstInput||(o.firstInput=z(e)),n>1&&!o.firstMultiple?o.firstMultiple=z(e):1===n&&(o.firstMultiple=!1);var s=o.firstInput,r=o.firstMultiple,a=r?r.center:s.center,l=e.center=A(i);e.timeStamp=yt(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=N(a,l),e.distance=L(a,l),C(o,e),e.offsetDirection=R(e.deltaX,e.deltaY);var c=M(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=_t(c.x)>_t(c.y)?c.x:c.y,e.scale=r?F(r.pointers,i):1,e.rotation=r?U(r.pointers,i):0,e.maxPointers=o.prevInput?e.pointers.length>o.prevInput.maxPointers?e.pointers.length:o.prevInput.maxPointers:e.pointers.length,D(o,e);var h=t.element;w(e.srcEvent.target,h)&&(h=e.srcEvent.target),e.target=h}function C(t,e){var o=e.center,i=t.offsetDelta||{},n=t.prevDelta||{},s=t.prevInput||{};e.eventType!==It&&s.eventType!==Ct||(n=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=t.offsetDelta={x:o.x,y:o.y}),e.deltaX=n.x+(o.x-i.x),e.deltaY=n.y+(o.y-i.y)}function D(t,e){var o,i,n,s,r=t.lastInterval||e,l=e.timeStamp-r.timeStamp;if(e.eventType!=Dt&&(l>Et||r.velocity===a)){var c=e.deltaX-r.deltaX,h=e.deltaY-r.deltaY,d=M(l,c,h);i=d.x,n=d.y,o=_t(d.x)>_t(d.y)?d.x:d.y,s=R(c,h),t.lastInterval=e}else o=r.velocity,i=r.velocityX,n=r.velocityY,s=r.direction;e.velocity=o,e.velocityX=i,e.velocityY=n,e.direction=s}function z(t){for(var e=[],o=0;o<t.pointers.length;)e[o]={clientX:wt(t.pointers[o].clientX),clientY:wt(t.pointers[o].clientY)},o++;return{timeStamp:yt(),pointers:e,center:A(e),deltaX:t.deltaX,deltaY:t.deltaY}}function A(t){var e=t.length;if(1===e)return{x:wt(t[0].clientX),y:wt(t[0].clientY)};for(var o=0,i=0,n=0;n<e;)o+=t[n].clientX,i+=t[n].clientY,n++;return{x:wt(o/e),y:wt(i/e)}}function M(t,e,o){return{x:e/t||0,y:o/t||0}}function R(t,e){return t===e?zt:_t(t)>=_t(e)?t<0?At:Mt:e<0?Rt:Lt}function L(t,e,o){o||(o=qt);var i=e[o[0]]-t[o[0]],n=e[o[1]]-t[o[1]];return Math.sqrt(i*i+n*n)}function N(t,e,o){o||(o=qt);var i=e[o[0]]-t[o[0]],n=e[o[1]]-t[o[1]];return 180*Math.atan2(n,i)/Math.PI}function U(t,e){return N(e[1],e[0],Bt)+N(t[1],t[0],Bt)}function F(t,e){return L(e[0],e[1],Bt)/L(t[0],t[1],Bt)}function q(){this.evEl=Yt,this.evWin=Ht,this.pressed=!1,S.apply(this,arguments)}function B(){this.evEl=Jt,this.evWin=Gt,S.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function W(){this.evTarget=Zt,this.evWin=Qt,this.started=!1,S.apply(this,arguments)}function Y(t,e){var o=j(t.touches),i=j(t.changedTouches);return e&(Ct|Dt)&&(o=k(o.concat(i),"identifier",!0)),[o,i]}function H(){this.evTarget=te,this.targetIds={},S.apply(this,arguments)}function X(t,e){var o=j(t.touches),i=this.targetIds;if(e&(It|Ot)&&1===o.length)return i[o[0].identifier]=!0,[o,o];var n,s,r=j(t.changedTouches),a=[],l=this.target;if(s=o.filter(function(t){return w(t.target,l)}),e===It)for(n=0;n<s.length;)i[s[n].identifier]=!0,n++;for(n=0;n<r.length;)i[r[n].identifier]&&a.push(r[n]),e&(Ct|Dt)&&delete i[r[n].identifier],n++;return a.length?[k(s.concat(a),"identifier",!0),a]:void 0}function V(){S.apply(this,arguments);var t=p(this.handler,this);this.touch=new H(this.manager,t),this.mouse=new q(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function J(t,e){t&It?(this.primaryTouch=e.changedPointers[0].identifier,G.call(this,e)):t&(Ct|Dt)&&G.call(this,e)}function G(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var o={x:e.clientX,y:e.clientY};this.lastTouches.push(o);var i=this.lastTouches,n=function(){var t=i.indexOf(o);t>-1&&i.splice(t,1)};setTimeout(n,ee)}}function K(t){for(var e=t.srcEvent.clientX,o=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var n=this.lastTouches[i],s=Math.abs(e-n.x),r=Math.abs(o-n.y);if(s<=oe&&r<=oe)return!0}return!1}function Z(t,e){this.manager=t,this.set(e)}function Q(t){if(_(t,ae))return ae;var e=_(t,le),o=_(t,ce);return e&&o?ae:e||o?e?le:ce:_(t,re)?re:se}function $(t){this.options=ft({},this.defaults,t||{}),this.id=x(),this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=de,this.simultaneous={},this.requireFail=[]}function tt(t){return t&ge?"cancel":t&fe?"end":t&pe?"move":t&ue?"start":""}function et(t){return t==Lt?"down":t==Rt?"up":t==At?"left":t==Mt?"right":""}function ot(t,e){var o=e.manager;return o?o.get(t):t}function it(){$.apply(this,arguments)}function nt(){it.apply(this,arguments),this.pX=null,this.pY=null}function st(){it.apply(this,arguments)}function rt(){$.apply(this,arguments),this._timer=null,this._input=null}function at(){it.apply(this,arguments)}function lt(){it.apply(this,arguments)}function ct(){$.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ht(t,e){return e=e||{},e.recognizers=m(e.recognizers,ht.defaults.preset),new dt(t,e)}function dt(t,e){this.options=ft({},ht.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=E(this),this.touchAction=new Z(this,this.options.touchAction),ut(this,!0),h(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ut(t,e){var o=t.element;if(o.style){var i;h(t.options.cssProps,function(n,s){i=T(o.style,s),e?(t.oldCssProps[i]=o.style[i],o.style[i]=n):o.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={})}}function pt(t,e){var o=s.createEvent("Event");o.initEvent(t,!0,!0),o.gesture=e,e.target.dispatchEvent(o)}var ft,mt=["","webkit","Moz","MS","ms","o"],gt=s.createElement("div"),vt="function",wt=Math.round,_t=Math.abs,yt=Date.now;ft="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),o=1;o<arguments.length;o++){var i=arguments[o];if(i!==a&&null!==i)for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e}:Object.assign;var bt=d(function(t,e,o){for(var i=Object.keys(e),n=0;n<i.length;)(!o||o&&t[i[n]]===a)&&(t[i[n]]=e[i[n]]),n++;return t},"extend","Use `assign`."),jt=d(function(t,e){return bt(t,e,!0)},"merge","Use `assign`."),kt=1,Tt=/mobile|tablet|ip(ad|hone|od)|android/i,xt="ontouchstart"in n,Pt=T(n,"PointerEvent")!==a,St=xt&&Tt.test(navigator.userAgent),Et=25,It=1,Ot=2,Ct=4,Dt=8,zt=1,At=2,Mt=4,Rt=8,Lt=16,Nt=At|Mt,Ut=Rt|Lt,Ft=Nt|Ut,qt=["x","y"],Bt=["clientX","clientY"];S.prototype={handler:function(){},init:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(P(this.element),this.evWin,this.domHandler)}};var Wt={mousedown:It,mousemove:Ot,mouseup:Ct},Yt="mousedown",Ht="mousemove mouseup";u(q,S,{handler:function(t){var e=Wt[t.type];e&It&&0===t.button&&(this.pressed=!0),e&Ot&&1!==t.which&&(e=Ct),this.pressed&&(e&Ct&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var Xt={pointerdown:It,pointermove:Ot,pointerup:Ct,pointercancel:Dt,pointerout:Dt},Vt={2:"touch",3:"pen",4:"mouse",5:"kinect"},Jt="pointerdown",Gt="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(Jt="MSPointerDown",Gt="MSPointerMove MSPointerUp MSPointerCancel"),u(B,S,{handler:function(t){var e=this.store,o=!1,i=t.type.toLowerCase().replace("ms",""),n=Xt[i],s=Vt[t.pointerType]||t.pointerType,r="touch"==s,a=b(e,t.pointerId,"pointerId");n&It&&(0===t.button||r)?a<0&&(e.push(t),a=e.length-1):n&(Ct|Dt)&&(o=!0),a<0||(e[a]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),o&&e.splice(a,1))}});var Kt={touchstart:It,touchmove:Ot,touchend:Ct,touchcancel:Dt},Zt="touchstart",Qt="touchstart touchmove touchend touchcancel";u(W,S,{handler:function(t){var e=Kt[t.type];if(e===It&&(this.started=!0),this.started){var o=Y.call(this,t,e);e&(Ct|Dt)&&o[0].length-o[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:o[0],changedPointers:o[1],pointerType:"touch",srcEvent:t})}}});var $t={touchstart:It,touchmove:Ot,touchend:Ct,touchcancel:Dt},te="touchstart touchmove touchend touchcancel";u(H,S,{handler:function(t){var e=$t[t.type],o=X.call(this,t,e);o&&this.callback(this.manager,e,{pointers:o[0],changedPointers:o[1],pointerType:"touch",srcEvent:t})}});var ee=2500,oe=25;u(V,S,{handler:function(t,e,o){var i="touch"==o.pointerType,n="mouse"==o.pointerType;if(!(n&&o.sourceCapabilities&&o.sourceCapabilities.firesTouchEvents)){if(i)J.call(this,e,o);else if(n&&K.call(this,o))return;this.callback(t,e,o)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ie=T(gt.style,"touchAction"),ne=ie!==a,se="auto",re="manipulation",ae="none",le="pan-x",ce="pan-y",he=function(){if(!ne)return!1;var t={},e=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(o){t[o]=!e||n.CSS.supports("touch-action",o)}),t}();Z.prototype={set:function(t){"compute"==t&&(t=this.compute()),ne&&this.manager.element.style&&he[t]&&(this.manager.element.style[ie]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return h(this.manager.recognizers,function(e){f(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Q(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,o=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var i=this.actions,n=_(i,ae)&&!he[ae],s=_(i,ce)&&!he[ce],r=_(i,le)&&!he[le];if(n){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}return r&&s?void 0:n||s&&o&Nt||r&&o&Ut?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var de=1,ue=2,pe=4,fe=8,me=fe,ge=16;$.prototype={defaults:{},set:function(t){return ft(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(c(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=ot(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return c(t,"dropRecognizeWith",this)?this:(t=ot(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(c(t,"requireFailure",this))return this;var e=this.requireFail;return t=ot(t,this),-1===b(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(c(t,"dropRequireFailure",this))return this;t=ot(t,this);var e=b(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){o.manager.emit(e,t)}var o=this,i=this.state;i<fe&&e(o.options.event+tt(i)),e(o.options.event),t.additionalEvent&&e(t.additionalEvent),i>=fe&&e(o.options.event+tt(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|de)))return!1;t++}return!0},recognize:function(t){var e=ft({},t);if(!f(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(me|ge|32)&&(this.state=de),this.state=this.process(e),this.state&(ue|pe|fe|ge)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},u(it,$,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,o=t.eventType,i=e&(ue|pe),n=this.attrTest(t);return i&&(o&Dt||!n)?e|ge:i||n?o&Ct?e|fe:e&ue?e|pe:ue:32}}),u(nt,it,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ft},getTouchAction:function(){var t=this.options.direction,e=[];return t&Nt&&e.push(ce),t&Ut&&e.push(le),e},directionTest:function(t){var e=this.options,o=!0,i=t.distance,n=t.direction,s=t.deltaX,r=t.deltaY;return n&e.direction||(e.direction&Nt?(n=0===s?zt:s<0?At:Mt,o=s!=this.pX,i=Math.abs(t.deltaX)):(n=0===r?zt:r<0?Rt:Lt,o=r!=this.pY,i=Math.abs(t.deltaY))),t.direction=n,o&&i>e.threshold&&n&e.direction},attrTest:function(t){return it.prototype.attrTest.call(this,t)&&(this.state&ue||!(this.state&ue)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=et(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),u(st,it,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ae]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ue)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),u(rt,$,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[se]},process:function(t){var e=this.options,o=t.pointers.length===e.pointers,i=t.distance<e.threshold,n=t.deltaTime>e.time;if(this._input=t,!i||!o||t.eventType&(Ct|Dt)&&!n)this.reset();else if(t.eventType&It)this.reset(),this._timer=l(function(){this.state=me,this.tryEmit()},e.time,this);else if(t.eventType&Ct)return me;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===me&&(t&&t.eventType&Ct?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=yt(),this.manager.emit(this.options.event,this._input)))}}),u(at,it,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ae]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ue)}}),u(lt,it,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Nt|Ut,pointers:1},getTouchAction:function(){return nt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,o=this.options.direction;return o&(Nt|Ut)?e=t.overallVelocity:o&Nt?e=t.overallVelocityX:o&Ut&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&o&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&_t(e)>this.options.velocity&&t.eventType&Ct},emit:function(t){var e=et(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),u(ct,$,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[re]},process:function(t){var e=this.options,o=t.pointers.length===e.pointers,i=t.distance<e.threshold,n=t.deltaTime<e.time;if(this.reset(),t.eventType&It&&0===this.count)return this.failTimeout();if(i&&n&&o){if(t.eventType!=Ct)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<e.interval,r=!this.pCenter||L(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,r&&s?this.count+=1:this.count=1,this._input=t;if(0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=l(function(){this.state=me,this.tryEmit()},e.interval,this),ue):me}return 32},failTimeout:function(){return this._timer=l(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==me&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ht.VERSION="2.0.7",ht.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[at,{enable:!1}],[st,{enable:!1},["rotate"]],[lt,{direction:Nt}],[nt,{direction:Nt},["swipe"]],[ct],[ct,{event:"doubletap",taps:2},["tap"]],[rt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};dt.prototype={set:function(t){return ft(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var o,i=this.recognizers,n=e.curRecognizer;(!n||n&&n.state&me)&&(n=e.curRecognizer=null);for(var s=0;s<i.length;)o=i[s],2===e.stopped||n&&o!=n&&!o.canRecognizeWith(n)?o.reset():o.recognize(t),!n&&o.state&(ue|pe|fe)&&(n=e.curRecognizer=o),s++}},get:function(t){if(t instanceof $)return t;for(var e=this.recognizers,o=0;o<e.length;o++)if(e[o].options.event==t)return e[o];return null},add:function(t){if(c(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(c(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,o=b(e,t);-1!==o&&(e.splice(o,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var o=this.handlers;return h(y(t),function(t){o[t]=o[t]||[],o[t].push(e)}),this}},off:function(t,e){if(t!==a){var o=this.handlers;return h(y(t),function(t){e?o[t]&&o[t].splice(b(o[t],e),1):delete o[t]}),this}},emit:function(t,e){this.options.domEvents&&pt(t,e);var o=this.handlers[t]&&this.handlers[t].slice();if(o&&o.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<o.length;)o[i](e),i++}},destroy:function(){this.element&&ut(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ft(ht,{INPUT_START:It,INPUT_MOVE:Ot,INPUT_END:Ct,INPUT_CANCEL:Dt,STATE_POSSIBLE:de,STATE_BEGAN:ue,STATE_CHANGED:pe,STATE_ENDED:fe,STATE_RECOGNIZED:me,STATE_CANCELLED:ge,STATE_FAILED:32,DIRECTION_NONE:zt,DIRECTION_LEFT:At,DIRECTION_RIGHT:Mt,DIRECTION_UP:Rt,DIRECTION_DOWN:Lt,DIRECTION_HORIZONTAL:Nt,DIRECTION_VERTICAL:Ut,DIRECTION_ALL:Ft,Manager:dt,Input:S,TouchAction:Z,TouchInput:H,MouseInput:q,PointerEventInput:B,TouchMouseInput:V,SingleTouchInput:W,Recognizer:$,AttrRecognizer:it,Tap:ct,Pan:nt,Swipe:lt,Pinch:st,Rotate:at,Press:rt,on:g,off:v,each:h,merge:jt,extend:bt,assign:ft,inherit:u,bindFn:p,prefixed:T}),(void 0!==n?n:"undefined"!=typeof self?self:{}).Hammer=ht,(i=function(){return ht}.call(e,o,e,t))!==a&&(t.exports=i)}(window,document)}});